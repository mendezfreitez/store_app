{"remainingRequest":"C:\\Users\\icald\\VueJS\\store_app\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\icald\\VueJS\\store_app\\src\\editor\\js\\excanvas.js","dependencies":[{"path":"C:\\Users\\icald\\VueJS\\store_app\\src\\editor\\js\\excanvas.js","mtime":1604637042533},{"path":"C:\\Users\\icald\\VueJS\\store_app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\icald\\VueJS\\store_app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbGwiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3RvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiKTsKCnZhciBfdHlwZW9mID0gcmVxdWlyZSgiQzovVXNlcnMvaWNhbGQvVnVlSlMvc3RvcmVfYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3R5cGVvZiIpOwoKLy8gQ29weXJpZ2h0IDIwMDYgR29vZ2xlIEluYy4KLy8KLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7Ci8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci8vCi8vICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCi8vCi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCi8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCi8vIEtub3duIElzc3VlczoKLy8KLy8gKiBQYXR0ZXJucyBhcmUgbm90IGltcGxlbWVudGVkLgovLyAqIFJhZGlhbCBncmFkaWVudCBhcmUgbm90IGltcGxlbWVudGVkLiBUaGUgVk1MIHZlcnNpb24gb2YgdGhlc2UgbG9vayB2ZXJ5Ci8vICAgZGlmZmVyZW50IGZyb20gdGhlIGNhbnZhcyBvbmUuCi8vICogQ2xpcHBpbmcgcGF0aHMgYXJlIG5vdCBpbXBsZW1lbnRlZC4KLy8gKiBDb29yZHNpemUuIFRoZSB3aWR0aCBhbmQgaGVpZ2h0IGF0dHJpYnV0ZSBoYXZlIGhpZ2hlciBwcmlvcml0eSB0aGFuIHRoZQovLyAgIHdpZHRoIGFuZCBoZWlnaHQgc3R5bGUgdmFsdWVzIHdoaWNoIGlzbid0IGNvcnJlY3QuCi8vICogUGFpbnRpbmcgbW9kZSBpc24ndCBpbXBsZW1lbnRlZC4KLy8gKiBDYW52YXMgd2lkdGgvaGVpZ2h0IHNob3VsZCBpcyB1c2luZyBjb250ZW50LWJveCBieSBkZWZhdWx0LiBJRSBpbgovLyAgIFF1aXJrcyBtb2RlIHdpbGwgZHJhdyB0aGUgY2FudmFzIHVzaW5nIGJvcmRlci1ib3guIEVpdGhlciBjaGFuZ2UgeW91cgovLyAgIGRvY3R5cGUgdG8gSFRNTDUKLy8gICAoaHR0cDovL3d3dy53aGF0d2cub3JnL3NwZWNzL3dlYi1hcHBzL2N1cnJlbnQtd29yay8jdGhlLWRvY3R5cGUpCi8vICAgb3IgdXNlIEJveCBTaXppbmcgQmVoYXZpb3IgZnJvbSBXZWJGWAovLyAgIChodHRwOi8vd2ViZnguZWFlLm5ldC9kaHRtbC9ib3hzaXppbmcvYm94c2l6aW5nLmh0bWwpCi8vICogTm9uIHVuaWZvcm0gc2NhbGluZyBkb2VzIG5vdCBjb3JyZWN0bHkgc2NhbGUgc3Ryb2tlcy4KLy8gKiBPcHRpbWl6ZS4gVGhlcmUgaXMgYWx3YXlzIHJvb20gZm9yIHNwZWVkIGltcHJvdmVtZW50cy4KLy8gT25seSBhZGQgdGhpcyBjb2RlIGlmIHdlIGRvIG5vdCBhbHJlYWR5IGhhdmUgYSBjYW52YXMgaW1wbGVtZW50YXRpb24KaWYgKCFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKS5nZXRDb250ZXh0KSB7CiAgKGZ1bmN0aW9uICgpIHsKICAgIC8vIGFsaWFzIHNvbWUgZnVuY3Rpb25zIHRvIG1ha2UgKGNvbXBpbGVkKSBjb2RlIHNob3J0ZXIKICAgIHZhciBtID0gTWF0aDsKICAgIHZhciBtciA9IG0ucm91bmQ7CiAgICB2YXIgbXMgPSBtLnNpbjsKICAgIHZhciBtYyA9IG0uY29zOwogICAgdmFyIGFicyA9IG0uYWJzOwogICAgdmFyIHNxcnQgPSBtLnNxcnQ7IC8vIHRoaXMgaXMgdXNlZCBmb3Igc3ViIHBpeGVsIHByZWNpc2lvbgoKICAgIHZhciBaID0gMTA7CiAgICB2YXIgWjIgPSBaIC8gMjsKICAgIC8qKgogICAgICogVGhpcyBmdW50aW9uIGlzIGFzc2lnbmVkIHRvIHRoZSA8Y2FudmFzPiBlbGVtZW50cyBhcyBlbGVtZW50LmdldENvbnRleHQoKS4KICAgICAqIEB0aGlzIHtIVE1MRWxlbWVudH0KICAgICAqIEByZXR1cm4ge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF99CiAgICAgKi8KCiAgICBmdW5jdGlvbiBnZXRDb250ZXh0KCkgewogICAgICByZXR1cm4gdGhpcy5jb250ZXh0XyB8fCAodGhpcy5jb250ZXh0XyA9IG5ldyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRfKHRoaXMpKTsKICAgIH0KCiAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CiAgICAvKioKICAgICAqIEJpbmRzIGEgZnVuY3Rpb24gdG8gYW4gb2JqZWN0LiBUaGUgcmV0dXJuZWQgZnVuY3Rpb24gd2lsbCBhbHdheXMgdXNlIHRoZQogICAgICogcGFzc2VkIGluIHtAY29kZSBvYmp9IGFzIHtAY29kZSB0aGlzfS4KICAgICAqCiAgICAgKiBFeGFtcGxlOgogICAgICoKICAgICAqICAgZyA9IGJpbmQoZiwgb2JqLCBhLCBiKQogICAgICogICBnKGMsIGQpIC8vIHdpbGwgZG8gZi5jYWxsKG9iaiwgYSwgYiwgYywgZCkKICAgICAqCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmIFRoZSBmdW5jdGlvbiB0byBiaW5kIHRoZSBvYmplY3QgdG8KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0aGF0IHNob3VsZCBhY3QgYXMgdGhpcyB3aGVuIHRoZSBmdW5jdGlvbgogICAgICogICAgIGlzIGNhbGxlZAogICAgICogQHBhcmFtIHsqfSB2YXJfYXJncyBSZXN0IGFyZ3VtZW50cyB0aGF0IHdpbGwgYmUgdXNlZCBhcyB0aGUgaW5pdGlhbAogICAgICogICAgIGFyZ3VtZW50cyB3aGVuIHRoZSBmdW5jdGlvbiBpcyBjYWxsZWQKICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbiB0aGF0IGhhcyBib3VuZCB0aGlzCiAgICAgKi8KCiAgICBmdW5jdGlvbiBiaW5kKGYsIG9iaiwgdmFyX2FyZ3MpIHsKICAgICAgdmFyIGEgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGYuYXBwbHkob2JqLCBhLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTsKICAgICAgfTsKICAgIH0KCiAgICB2YXIgR192bWxDYW52YXNNYW5hZ2VyXyA9IHsKICAgICAgaW5pdDogZnVuY3Rpb24gaW5pdChvcHRfZG9jKSB7CiAgICAgICAgaWYgKC9NU0lFLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmICF3aW5kb3cub3BlcmEpIHsKICAgICAgICAgIHZhciBkb2MgPSBvcHRfZG9jIHx8IGRvY3VtZW50OyAvLyBDcmVhdGUgYSBkdW1teSBlbGVtZW50IHNvIHRoYXQgSUUgd2lsbCBhbGxvdyBjYW52YXMgZWxlbWVudHMgdG8gYmUKICAgICAgICAgIC8vIHJlY29nbml6ZWQuCgogICAgICAgICAgZG9jLmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICAgICAgZG9jLmF0dGFjaEV2ZW50KCdvbnJlYWR5c3RhdGVjaGFuZ2UnLCBiaW5kKHRoaXMuaW5pdF8sIHRoaXMsIGRvYykpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5pdF86IGZ1bmN0aW9uIGluaXRfKGRvYykgewogICAgICAgIC8vIGNyZWF0ZSB4bWxucwogICAgICAgIGlmICghZG9jLm5hbWVzcGFjZXNbJ2dfdm1sXyddKSB7CiAgICAgICAgICBkb2MubmFtZXNwYWNlcy5hZGQoJ2dfdm1sXycsICd1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbCcsICcjZGVmYXVsdCNWTUwnKTsKICAgICAgICB9CgogICAgICAgIGlmICghZG9jLm5hbWVzcGFjZXNbJ2dfb18nXSkgewogICAgICAgICAgZG9jLm5hbWVzcGFjZXMuYWRkKCdnX29fJywgJ3VybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZScsICcjZGVmYXVsdCNWTUwnKTsKICAgICAgICB9IC8vIFNldHVwIGRlZmF1bHQgQ1NTLiAgT25seSBhZGQgb25lIHN0eWxlIHNoZWV0IHBlciBkb2N1bWVudAoKCiAgICAgICAgaWYgKCFkb2Muc3R5bGVTaGVldHNbJ2V4X2NhbnZhc18nXSkgewogICAgICAgICAgdmFyIHNzID0gZG9jLmNyZWF0ZVN0eWxlU2hlZXQoKTsKICAgICAgICAgIHNzLm93bmluZ0VsZW1lbnQuaWQgPSAnZXhfY2FudmFzXyc7CiAgICAgICAgICBzcy5jc3NUZXh0ID0gJ2NhbnZhc3tkaXNwbGF5OmlubGluZS1ibG9jaztvdmVyZmxvdzpoaWRkZW47JyArIC8vIGRlZmF1bHQgc2l6ZSBpcyAzMDB4MTUwIGluIEdlY2tvIGFuZCBPcGVyYQogICAgICAgICAgJ3RleHQtYWxpZ246bGVmdDt3aWR0aDozMDBweDtoZWlnaHQ6MTUwcHh9JyArICdnX3ZtbF9cXDoqe2JlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpfScgKyAnZ19vX1xcOip7YmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCl9JzsKICAgICAgICB9IC8vIGZpbmQgYWxsIGNhbnZhcyBlbGVtZW50cwoKCiAgICAgICAgdmFyIGVscyA9IGRvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY2FudmFzJyk7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB0aGlzLmluaXRFbGVtZW50KGVsc1tpXSk7CiAgICAgICAgfQogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAqIFB1YmxpYyBpbml0aWFsaXplcyBhIGNhbnZhcyBlbGVtZW50IHNvIHRoYXQgaXQgY2FuIGJlIHVzZWQgYXMgY2FudmFzCiAgICAgICAqIGVsZW1lbnQgZnJvbSBub3cgb24uIFRoaXMgaXMgY2FsbGVkIGF1dG9tYXRpY2FsbHkgYmVmb3JlIHRoZSBwYWdlIGlzCiAgICAgICAqIGxvYWRlZCBidXQgaWYgeW91IGFyZSBjcmVhdGluZyBlbGVtZW50cyB1c2luZyBjcmVhdGVFbGVtZW50IHlvdSBuZWVkIHRvCiAgICAgICAqIG1ha2Ugc3VyZSB0aGlzIGlzIGNhbGxlZCBvbiB0aGUgZWxlbWVudC4KICAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWwgVGhlIGNhbnZhcyBlbGVtZW50IHRvIGluaXRpYWxpemUuCiAgICAgICAqIEByZXR1cm4ge0hUTUxFbGVtZW50fSB0aGUgZWxlbWVudCB0aGF0IHdhcyBjcmVhdGVkLgogICAgICAgKi8KICAgICAgaW5pdEVsZW1lbnQ6IGZ1bmN0aW9uIGluaXRFbGVtZW50KGVsKSB7CiAgICAgICAgaWYgKCFlbC5nZXRDb250ZXh0KSB7CiAgICAgICAgICBlbC5nZXRDb250ZXh0ID0gZ2V0Q29udGV4dDsgLy8gUmVtb3ZlIGZhbGxiYWNrIGNvbnRlbnQuIFRoZXJlIGlzIG5vIHdheSB0byBoaWRlIHRleHQgbm9kZXMgc28gd2UKICAgICAgICAgIC8vIGp1c3QgcmVtb3ZlIGFsbCBjaGlsZE5vZGVzLiBXZSBjb3VsZCBoaWRlIGFsbCBlbGVtZW50cyBhbmQgcmVtb3ZlCiAgICAgICAgICAvLyB0ZXh0IG5vZGVzIGJ1dCB3aG8gcmVhbGx5IGNhcmVzIGFib3V0IHRoZSBmYWxsYmFjayBjb250ZW50LgoKICAgICAgICAgIGVsLmlubmVySFRNTCA9ICcnOyAvLyBkbyBub3QgdXNlIGlubGluZSBmdW5jdGlvbiBiZWNhdXNlIHRoYXQgd2lsbCBsZWFrIG1lbW9yeQoKICAgICAgICAgIGVsLmF0dGFjaEV2ZW50KCdvbnByb3BlcnR5Y2hhbmdlJywgb25Qcm9wZXJ0eUNoYW5nZSk7CiAgICAgICAgICBlbC5hdHRhY2hFdmVudCgnb25yZXNpemUnLCBvblJlc2l6ZSk7CiAgICAgICAgICB2YXIgYXR0cnMgPSBlbC5hdHRyaWJ1dGVzOwoKICAgICAgICAgIGlmIChhdHRycy53aWR0aCAmJiBhdHRycy53aWR0aC5zcGVjaWZpZWQpIHsKICAgICAgICAgICAgLy8gVE9ETzogdXNlIHJ1bnRpbWVTdHlsZSBhbmQgY29vcmRzaXplCiAgICAgICAgICAgIC8vIGVsLmdldENvbnRleHQoKS5zZXRXaWR0aF8oYXR0cnMud2lkdGgubm9kZVZhbHVlKTsKICAgICAgICAgICAgZWwuc3R5bGUud2lkdGggPSBhdHRycy53aWR0aC5ub2RlVmFsdWUgKyAncHgnOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZWwud2lkdGggPSBlbC5jbGllbnRXaWR0aDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoYXR0cnMuaGVpZ2h0ICYmIGF0dHJzLmhlaWdodC5zcGVjaWZpZWQpIHsKICAgICAgICAgICAgLy8gVE9ETzogdXNlIHJ1bnRpbWVTdHlsZSBhbmQgY29vcmRzaXplCiAgICAgICAgICAgIC8vIGVsLmdldENvbnRleHQoKS5zZXRIZWlnaHRfKGF0dHJzLmhlaWdodC5ub2RlVmFsdWUpOwogICAgICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSBhdHRycy5oZWlnaHQubm9kZVZhbHVlICsgJ3B4JzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVsLmhlaWdodCA9IGVsLmNsaWVudEhlaWdodDsKICAgICAgICAgIH0gLy9lbC5nZXRDb250ZXh0KCkuc2V0Q29vcmRzaXplXygpCgogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGVsOwogICAgICB9CiAgICB9OwoKICAgIGZ1bmN0aW9uIG9uUHJvcGVydHlDaGFuZ2UoZSkgewogICAgICB2YXIgZWwgPSBlLnNyY0VsZW1lbnQ7CgogICAgICBzd2l0Y2ggKGUucHJvcGVydHlOYW1lKSB7CiAgICAgICAgY2FzZSAnd2lkdGgnOgogICAgICAgICAgZWwuc3R5bGUud2lkdGggPSBlbC5hdHRyaWJ1dGVzLndpZHRoLm5vZGVWYWx1ZSArICdweCc7CiAgICAgICAgICBlbC5nZXRDb250ZXh0KCkuY2xlYXJSZWN0KCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnaGVpZ2h0JzoKICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9IGVsLmF0dHJpYnV0ZXMuaGVpZ2h0Lm5vZGVWYWx1ZSArICdweCc7CiAgICAgICAgICBlbC5nZXRDb250ZXh0KCkuY2xlYXJSZWN0KCk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIG9uUmVzaXplKGUpIHsKICAgICAgdmFyIGVsID0gZS5zcmNFbGVtZW50OwoKICAgICAgaWYgKGVsLmZpcnN0Q2hpbGQpIHsKICAgICAgICBlbC5maXJzdENoaWxkLnN0eWxlLndpZHRoID0gZWwuY2xpZW50V2lkdGggKyAncHgnOwogICAgICAgIGVsLmZpcnN0Q2hpbGQuc3R5bGUuaGVpZ2h0ID0gZWwuY2xpZW50SGVpZ2h0ICsgJ3B4JzsKICAgICAgfQogICAgfQoKICAgIEdfdm1sQ2FudmFzTWFuYWdlcl8uaW5pdCgpOyAvLyBwcmVjb21wdXRlICIwMCIgdG8gIkZGIgoKICAgIHZhciBkZWMyaGV4ID0gW107CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTY7IGorKykgewogICAgICAgIGRlYzJoZXhbaSAqIDE2ICsgal0gPSBpLnRvU3RyaW5nKDE2KSArIGoudG9TdHJpbmcoMTYpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlTWF0cml4SWRlbnRpdHkoKSB7CiAgICAgIHJldHVybiBbWzEsIDAsIDBdLCBbMCwgMSwgMF0sIFswLCAwLCAxXV07CiAgICB9CgogICAgZnVuY3Rpb24gbWF0cml4TXVsdGlwbHkobTEsIG0yKSB7CiAgICAgIHZhciByZXN1bHQgPSBjcmVhdGVNYXRyaXhJZGVudGl0eSgpOwoKICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCAzOyB4KyspIHsKICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IDM7IHkrKykgewogICAgICAgICAgdmFyIHN1bSA9IDA7CgogICAgICAgICAgZm9yICh2YXIgeiA9IDA7IHogPCAzOyB6KyspIHsKICAgICAgICAgICAgc3VtICs9IG0xW3hdW3pdICogbTJbel1beV07CiAgICAgICAgICB9CgogICAgICAgICAgcmVzdWx0W3hdW3ldID0gc3VtOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICBmdW5jdGlvbiBjb3B5U3RhdGUobzEsIG8yKSB7CiAgICAgIG8yLmZpbGxTdHlsZSA9IG8xLmZpbGxTdHlsZTsKICAgICAgbzIubGluZUNhcCA9IG8xLmxpbmVDYXA7CiAgICAgIG8yLmxpbmVKb2luID0gbzEubGluZUpvaW47CiAgICAgIG8yLmxpbmVXaWR0aCA9IG8xLmxpbmVXaWR0aDsKICAgICAgbzIubWl0ZXJMaW1pdCA9IG8xLm1pdGVyTGltaXQ7CiAgICAgIG8yLnNoYWRvd0JsdXIgPSBvMS5zaGFkb3dCbHVyOwogICAgICBvMi5zaGFkb3dDb2xvciA9IG8xLnNoYWRvd0NvbG9yOwogICAgICBvMi5zaGFkb3dPZmZzZXRYID0gbzEuc2hhZG93T2Zmc2V0WDsKICAgICAgbzIuc2hhZG93T2Zmc2V0WSA9IG8xLnNoYWRvd09mZnNldFk7CiAgICAgIG8yLnN0cm9rZVN0eWxlID0gbzEuc3Ryb2tlU3R5bGU7CiAgICAgIG8yLmdsb2JhbEFscGhhID0gbzEuZ2xvYmFsQWxwaGE7CiAgICAgIG8yLmFyY1NjYWxlWF8gPSBvMS5hcmNTY2FsZVhfOwogICAgICBvMi5hcmNTY2FsZVlfID0gbzEuYXJjU2NhbGVZXzsKICAgICAgbzIubGluZVNjYWxlXyA9IG8xLmxpbmVTY2FsZV87CiAgICB9CgogICAgZnVuY3Rpb24gcHJvY2Vzc1N0eWxlKHN0eWxlU3RyaW5nKSB7CiAgICAgIHZhciBzdHIsCiAgICAgICAgICBhbHBoYSA9IDE7CiAgICAgIHN0eWxlU3RyaW5nID0gU3RyaW5nKHN0eWxlU3RyaW5nKTsKCiAgICAgIGlmIChzdHlsZVN0cmluZy5zdWJzdHJpbmcoMCwgMykgPT0gJ3JnYicpIHsKICAgICAgICB2YXIgc3RhcnQgPSBzdHlsZVN0cmluZy5pbmRleE9mKCcoJywgMyk7CiAgICAgICAgdmFyIGVuZCA9IHN0eWxlU3RyaW5nLmluZGV4T2YoJyknLCBzdGFydCArIDEpOwogICAgICAgIHZhciBndXRzID0gc3R5bGVTdHJpbmcuc3Vic3RyaW5nKHN0YXJ0ICsgMSwgZW5kKS5zcGxpdCgnLCcpOwogICAgICAgIHN0ciA9ICcjJzsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKICAgICAgICAgIHN0ciArPSBkZWMyaGV4W051bWJlcihndXRzW2ldKV07CiAgICAgICAgfQoKICAgICAgICBpZiAoZ3V0cy5sZW5ndGggPT0gNCAmJiBzdHlsZVN0cmluZy5zdWJzdHIoMywgMSkgPT0gJ2EnKSB7CiAgICAgICAgICBhbHBoYSA9IGd1dHNbM107CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHN0ciA9IHN0eWxlU3RyaW5nOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGNvbG9yOiBzdHIsCiAgICAgICAgYWxwaGE6IGFscGhhCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gcHJvY2Vzc0xpbmVDYXAobGluZUNhcCkgewogICAgICBzd2l0Y2ggKGxpbmVDYXApIHsKICAgICAgICBjYXNlICdidXR0JzoKICAgICAgICAgIHJldHVybiAnZmxhdCc7CgogICAgICAgIGNhc2UgJ3JvdW5kJzoKICAgICAgICAgIHJldHVybiAncm91bmQnOwoKICAgICAgICBjYXNlICdzcXVhcmUnOgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICByZXR1cm4gJ3NxdWFyZSc7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVGhpcyBjbGFzcyBpbXBsZW1lbnRzIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCBpbnRlcmZhY2UgYXMgZGVzY3JpYmVkIGJ5CiAgICAgKiB0aGUgV0hBVFdHLgogICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gc3VyZmFjZUVsZW1lbnQgVGhlIGVsZW1lbnQgdGhhdCB0aGUgMkQgY29udGV4dCBzaG91bGQKICAgICAqIGJlIGFzc29jaWF0ZWQgd2l0aAogICAgICovCgoKICAgIGZ1bmN0aW9uIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF8oc3VyZmFjZUVsZW1lbnQpIHsKICAgICAgdGhpcy5tXyA9IGNyZWF0ZU1hdHJpeElkZW50aXR5KCk7CiAgICAgIHRoaXMubVN0YWNrXyA9IFtdOwogICAgICB0aGlzLmFTdGFja18gPSBbXTsKICAgICAgdGhpcy5jdXJyZW50UGF0aF8gPSBbXTsgLy8gQ2FudmFzIGNvbnRleHQgcHJvcGVydGllcwoKICAgICAgdGhpcy5zdHJva2VTdHlsZSA9ICcjMDAwJzsKICAgICAgdGhpcy5maWxsU3R5bGUgPSAnIzAwMCc7CiAgICAgIHRoaXMubGluZVdpZHRoID0gMTsKICAgICAgdGhpcy5saW5lSm9pbiA9ICdtaXRlcic7CiAgICAgIHRoaXMubGluZUNhcCA9ICdidXR0JzsKICAgICAgdGhpcy5taXRlckxpbWl0ID0gWiAqIDE7CiAgICAgIHRoaXMuZ2xvYmFsQWxwaGEgPSAxOwogICAgICB0aGlzLmNhbnZhcyA9IHN1cmZhY2VFbGVtZW50OwogICAgICB2YXIgZWwgPSBzdXJmYWNlRWxlbWVudC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICBlbC5zdHlsZS53aWR0aCA9IHN1cmZhY2VFbGVtZW50LmNsaWVudFdpZHRoICsgJ3B4JzsKICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gc3VyZmFjZUVsZW1lbnQuY2xpZW50SGVpZ2h0ICsgJ3B4JzsKICAgICAgZWwuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJzsKICAgICAgZWwuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOwogICAgICBzdXJmYWNlRWxlbWVudC5hcHBlbmRDaGlsZChlbCk7CiAgICAgIHRoaXMuZWxlbWVudF8gPSBlbDsKICAgICAgdGhpcy5hcmNTY2FsZVhfID0gMTsKICAgICAgdGhpcy5hcmNTY2FsZVlfID0gMTsKICAgICAgdGhpcy5saW5lU2NhbGVfID0gMTsKICAgIH0KCiAgICB2YXIgY29udGV4dFByb3RvdHlwZSA9IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF8ucHJvdG90eXBlOwoKICAgIGNvbnRleHRQcm90b3R5cGUuY2xlYXJSZWN0ID0gZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmVsZW1lbnRfLmlubmVySFRNTCA9ICcnOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLmJlZ2luUGF0aCA9IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gVE9ETzogQnJhbmNoIGN1cnJlbnQgbWF0cml4IHNvIHRoYXQgc2F2ZS9yZXN0b3JlIGhhcyBubyBlZmZlY3QKICAgICAgLy8gICAgICAgYXMgcGVyIHNhZmFyaSBkb2NzLgogICAgICB0aGlzLmN1cnJlbnRQYXRoXyA9IFtdOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLm1vdmVUbyA9IGZ1bmN0aW9uIChhWCwgYVkpIHsKICAgICAgdmFyIHAgPSB0aGlzLmdldENvb3Jkc18oYVgsIGFZKTsKICAgICAgdGhpcy5jdXJyZW50UGF0aF8ucHVzaCh7CiAgICAgICAgdHlwZTogJ21vdmVUbycsCiAgICAgICAgeDogcC54LAogICAgICAgIHk6IHAueQogICAgICB9KTsKICAgICAgdGhpcy5jdXJyZW50WF8gPSBwLng7CiAgICAgIHRoaXMuY3VycmVudFlfID0gcC55OwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLmxpbmVUbyA9IGZ1bmN0aW9uIChhWCwgYVkpIHsKICAgICAgdmFyIHAgPSB0aGlzLmdldENvb3Jkc18oYVgsIGFZKTsKICAgICAgdGhpcy5jdXJyZW50UGF0aF8ucHVzaCh7CiAgICAgICAgdHlwZTogJ2xpbmVUbycsCiAgICAgICAgeDogcC54LAogICAgICAgIHk6IHAueQogICAgICB9KTsKICAgICAgdGhpcy5jdXJyZW50WF8gPSBwLng7CiAgICAgIHRoaXMuY3VycmVudFlfID0gcC55OwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLmJlemllckN1cnZlVG8gPSBmdW5jdGlvbiAoYUNQMXgsIGFDUDF5LCBhQ1AyeCwgYUNQMnksIGFYLCBhWSkgewogICAgICB2YXIgcCA9IHRoaXMuZ2V0Q29vcmRzXyhhWCwgYVkpOwogICAgICB2YXIgY3AxID0gdGhpcy5nZXRDb29yZHNfKGFDUDF4LCBhQ1AxeSk7CiAgICAgIHZhciBjcDIgPSB0aGlzLmdldENvb3Jkc18oYUNQMngsIGFDUDJ5KTsKICAgICAgYmV6aWVyQ3VydmVUbyh0aGlzLCBjcDEsIGNwMiwgcCk7CiAgICB9OyAvLyBIZWxwZXIgZnVuY3Rpb24gdGhhdCB0YWtlcyB0aGUgYWxyZWFkeSBmaXhlZCBjb3JkaW5hdGVzLgoKCiAgICBmdW5jdGlvbiBiZXppZXJDdXJ2ZVRvKHNlbGYsIGNwMSwgY3AyLCBwKSB7CiAgICAgIHNlbGYuY3VycmVudFBhdGhfLnB1c2goewogICAgICAgIHR5cGU6ICdiZXppZXJDdXJ2ZVRvJywKICAgICAgICBjcDF4OiBjcDEueCwKICAgICAgICBjcDF5OiBjcDEueSwKICAgICAgICBjcDJ4OiBjcDIueCwKICAgICAgICBjcDJ5OiBjcDIueSwKICAgICAgICB4OiBwLngsCiAgICAgICAgeTogcC55CiAgICAgIH0pOwogICAgICBzZWxmLmN1cnJlbnRYXyA9IHAueDsKICAgICAgc2VsZi5jdXJyZW50WV8gPSBwLnk7CiAgICB9CgogICAgY29udGV4dFByb3RvdHlwZS5xdWFkcmF0aWNDdXJ2ZVRvID0gZnVuY3Rpb24gKGFDUHgsIGFDUHksIGFYLCBhWSkgewogICAgICAvLyB0aGUgZm9sbG93aW5nIGlzIGxpZnRlZCBhbG1vc3QgZGlyZWN0bHkgZnJvbQogICAgICAvLyBodHRwOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL2RvY3MvQ2FudmFzX3R1dG9yaWFsOkRyYXdpbmdfc2hhcGVzCiAgICAgIHZhciBjcCA9IHRoaXMuZ2V0Q29vcmRzXyhhQ1B4LCBhQ1B5KTsKICAgICAgdmFyIHAgPSB0aGlzLmdldENvb3Jkc18oYVgsIGFZKTsKICAgICAgdmFyIGNwMSA9IHsKICAgICAgICB4OiB0aGlzLmN1cnJlbnRYXyArIDIuMCAvIDMuMCAqIChjcC54IC0gdGhpcy5jdXJyZW50WF8pLAogICAgICAgIHk6IHRoaXMuY3VycmVudFlfICsgMi4wIC8gMy4wICogKGNwLnkgLSB0aGlzLmN1cnJlbnRZXykKICAgICAgfTsKICAgICAgdmFyIGNwMiA9IHsKICAgICAgICB4OiBjcDEueCArIChwLnggLSB0aGlzLmN1cnJlbnRYXykgLyAzLjAsCiAgICAgICAgeTogY3AxLnkgKyAocC55IC0gdGhpcy5jdXJyZW50WV8pIC8gMy4wCiAgICAgIH07CiAgICAgIGJlemllckN1cnZlVG8odGhpcywgY3AxLCBjcDIsIHApOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLmFyYyA9IGZ1bmN0aW9uIChhWCwgYVksIGFSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UpIHsKICAgICAgYVJhZGl1cyAqPSBaOwogICAgICB2YXIgYXJjVHlwZSA9IGFDbG9ja3dpc2UgPyAnYXQnIDogJ3dhJzsKICAgICAgdmFyIHhTdGFydCA9IGFYICsgbWMoYVN0YXJ0QW5nbGUpICogYVJhZGl1cyAtIFoyOwogICAgICB2YXIgeVN0YXJ0ID0gYVkgKyBtcyhhU3RhcnRBbmdsZSkgKiBhUmFkaXVzIC0gWjI7CiAgICAgIHZhciB4RW5kID0gYVggKyBtYyhhRW5kQW5nbGUpICogYVJhZGl1cyAtIFoyOwogICAgICB2YXIgeUVuZCA9IGFZICsgbXMoYUVuZEFuZ2xlKSAqIGFSYWRpdXMgLSBaMjsgLy8gSUUgd29uJ3QgcmVuZGVyIGFyY2hlcyBkcmF3biBjb3VudGVyIGNsb2Nrd2lzZSBpZiB4U3RhcnQgPT0geEVuZC4KCiAgICAgIGlmICh4U3RhcnQgPT0geEVuZCAmJiAhYUNsb2Nrd2lzZSkgewogICAgICAgIHhTdGFydCArPSAwLjEyNTsgLy8gT2Zmc2V0IHhTdGFydCBieSAxLzgwIG9mIGEgcGl4ZWwuIFVzZSBzb21ldGhpbmcKICAgICAgICAvLyB0aGF0IGNhbiBiZSByZXByZXNlbnRlZCBpbiBiaW5hcnkKICAgICAgfQoKICAgICAgdmFyIHAgPSB0aGlzLmdldENvb3Jkc18oYVgsIGFZKTsKICAgICAgdmFyIHBTdGFydCA9IHRoaXMuZ2V0Q29vcmRzXyh4U3RhcnQsIHlTdGFydCk7CiAgICAgIHZhciBwRW5kID0gdGhpcy5nZXRDb29yZHNfKHhFbmQsIHlFbmQpOwogICAgICB0aGlzLmN1cnJlbnRQYXRoXy5wdXNoKHsKICAgICAgICB0eXBlOiBhcmNUeXBlLAogICAgICAgIHg6IHAueCwKICAgICAgICB5OiBwLnksCiAgICAgICAgcmFkaXVzOiBhUmFkaXVzLAogICAgICAgIHhTdGFydDogcFN0YXJ0LngsCiAgICAgICAgeVN0YXJ0OiBwU3RhcnQueSwKICAgICAgICB4RW5kOiBwRW5kLngsCiAgICAgICAgeUVuZDogcEVuZC55CiAgICAgIH0pOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLnJlY3QgPSBmdW5jdGlvbiAoYVgsIGFZLCBhV2lkdGgsIGFIZWlnaHQpIHsKICAgICAgdGhpcy5tb3ZlVG8oYVgsIGFZKTsKICAgICAgdGhpcy5saW5lVG8oYVggKyBhV2lkdGgsIGFZKTsKICAgICAgdGhpcy5saW5lVG8oYVggKyBhV2lkdGgsIGFZICsgYUhlaWdodCk7CiAgICAgIHRoaXMubGluZVRvKGFYLCBhWSArIGFIZWlnaHQpOwogICAgICB0aGlzLmNsb3NlUGF0aCgpOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLnN0cm9rZVJlY3QgPSBmdW5jdGlvbiAoYVgsIGFZLCBhV2lkdGgsIGFIZWlnaHQpIHsKICAgICAgdmFyIG9sZFBhdGggPSB0aGlzLmN1cnJlbnRQYXRoXzsKICAgICAgdGhpcy5iZWdpblBhdGgoKTsKICAgICAgdGhpcy5tb3ZlVG8oYVgsIGFZKTsKICAgICAgdGhpcy5saW5lVG8oYVggKyBhV2lkdGgsIGFZKTsKICAgICAgdGhpcy5saW5lVG8oYVggKyBhV2lkdGgsIGFZICsgYUhlaWdodCk7CiAgICAgIHRoaXMubGluZVRvKGFYLCBhWSArIGFIZWlnaHQpOwogICAgICB0aGlzLmNsb3NlUGF0aCgpOwogICAgICB0aGlzLnN0cm9rZSgpOwogICAgICB0aGlzLmN1cnJlbnRQYXRoXyA9IG9sZFBhdGg7CiAgICB9OwoKICAgIGNvbnRleHRQcm90b3R5cGUuZmlsbFJlY3QgPSBmdW5jdGlvbiAoYVgsIGFZLCBhV2lkdGgsIGFIZWlnaHQpIHsKICAgICAgdmFyIG9sZFBhdGggPSB0aGlzLmN1cnJlbnRQYXRoXzsKICAgICAgdGhpcy5iZWdpblBhdGgoKTsKICAgICAgdGhpcy5tb3ZlVG8oYVgsIGFZKTsKICAgICAgdGhpcy5saW5lVG8oYVggKyBhV2lkdGgsIGFZKTsKICAgICAgdGhpcy5saW5lVG8oYVggKyBhV2lkdGgsIGFZICsgYUhlaWdodCk7CiAgICAgIHRoaXMubGluZVRvKGFYLCBhWSArIGFIZWlnaHQpOwogICAgICB0aGlzLmNsb3NlUGF0aCgpOwogICAgICB0aGlzLmZpbGwoKTsKICAgICAgdGhpcy5jdXJyZW50UGF0aF8gPSBvbGRQYXRoOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLmNyZWF0ZUxpbmVhckdyYWRpZW50ID0gZnVuY3Rpb24gKGFYMCwgYVkwLCBhWDEsIGFZMSkgewogICAgICB2YXIgZ3JhZGllbnQgPSBuZXcgQ2FudmFzR3JhZGllbnRfKCdncmFkaWVudCcpOwogICAgICBncmFkaWVudC54MF8gPSBhWDA7CiAgICAgIGdyYWRpZW50LnkwXyA9IGFZMDsKICAgICAgZ3JhZGllbnQueDFfID0gYVgxOwogICAgICBncmFkaWVudC55MV8gPSBhWTE7CiAgICAgIHJldHVybiBncmFkaWVudDsKICAgIH07CgogICAgY29udGV4dFByb3RvdHlwZS5jcmVhdGVSYWRpYWxHcmFkaWVudCA9IGZ1bmN0aW9uIChhWDAsIGFZMCwgYVIwLCBhWDEsIGFZMSwgYVIxKSB7CiAgICAgIHZhciBncmFkaWVudCA9IG5ldyBDYW52YXNHcmFkaWVudF8oJ2dyYWRpZW50cmFkaWFsJyk7CiAgICAgIGdyYWRpZW50LngwXyA9IGFYMDsKICAgICAgZ3JhZGllbnQueTBfID0gYVkwOwogICAgICBncmFkaWVudC5yMF8gPSBhUjA7CiAgICAgIGdyYWRpZW50LngxXyA9IGFYMTsKICAgICAgZ3JhZGllbnQueTFfID0gYVkxOwogICAgICBncmFkaWVudC5yMV8gPSBhUjE7CiAgICAgIHJldHVybiBncmFkaWVudDsKICAgIH07CgogICAgY29udGV4dFByb3RvdHlwZS5kcmF3SW1hZ2UgPSBmdW5jdGlvbiAoaW1hZ2UsIHZhcl9hcmdzKSB7CiAgICAgIHZhciBkeCwgZHksIGR3LCBkaCwgc3gsIHN5LCBzdywgc2g7IC8vIHRvIGZpbmQgdGhlIG9yaWdpbmFsIHdpZHRoIHdlIG92ZXJpZGUgdGhlIHdpZHRoIGFuZCBoZWlnaHQKCiAgICAgIHZhciBvbGRSdW50aW1lV2lkdGggPSBpbWFnZS5ydW50aW1lU3R5bGUud2lkdGg7CiAgICAgIHZhciBvbGRSdW50aW1lSGVpZ2h0ID0gaW1hZ2UucnVudGltZVN0eWxlLmhlaWdodDsKICAgICAgaW1hZ2UucnVudGltZVN0eWxlLndpZHRoID0gJ2F1dG8nOwogICAgICBpbWFnZS5ydW50aW1lU3R5bGUuaGVpZ2h0ID0gJ2F1dG8nOyAvLyBnZXQgdGhlIG9yaWdpbmFsIHNpemUKCiAgICAgIHZhciB3ID0gaW1hZ2Uud2lkdGg7CiAgICAgIHZhciBoID0gaW1hZ2UuaGVpZ2h0OyAvLyBhbmQgcmVtb3ZlIG92ZXJpZGVzCgogICAgICBpbWFnZS5ydW50aW1lU3R5bGUud2lkdGggPSBvbGRSdW50aW1lV2lkdGg7CiAgICAgIGltYWdlLnJ1bnRpbWVTdHlsZS5oZWlnaHQgPSBvbGRSdW50aW1lSGVpZ2h0OwoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMykgewogICAgICAgIGR4ID0gYXJndW1lbnRzWzFdOwogICAgICAgIGR5ID0gYXJndW1lbnRzWzJdOwogICAgICAgIHN4ID0gc3kgPSAwOwogICAgICAgIHN3ID0gZHcgPSB3OwogICAgICAgIHNoID0gZGggPSBoOwogICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gNSkgewogICAgICAgIGR4ID0gYXJndW1lbnRzWzFdOwogICAgICAgIGR5ID0gYXJndW1lbnRzWzJdOwogICAgICAgIGR3ID0gYXJndW1lbnRzWzNdOwogICAgICAgIGRoID0gYXJndW1lbnRzWzRdOwogICAgICAgIHN4ID0gc3kgPSAwOwogICAgICAgIHN3ID0gdzsKICAgICAgICBzaCA9IGg7CiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSA5KSB7CiAgICAgICAgc3ggPSBhcmd1bWVudHNbMV07CiAgICAgICAgc3kgPSBhcmd1bWVudHNbMl07CiAgICAgICAgc3cgPSBhcmd1bWVudHNbM107CiAgICAgICAgc2ggPSBhcmd1bWVudHNbNF07CiAgICAgICAgZHggPSBhcmd1bWVudHNbNV07CiAgICAgICAgZHkgPSBhcmd1bWVudHNbNl07CiAgICAgICAgZHcgPSBhcmd1bWVudHNbN107CiAgICAgICAgZGggPSBhcmd1bWVudHNbOF07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgRXJyb3IoJ0ludmFsaWQgbnVtYmVyIG9mIGFyZ3VtZW50cycpOwogICAgICB9CgogICAgICB2YXIgZCA9IHRoaXMuZ2V0Q29vcmRzXyhkeCwgZHkpOwogICAgICB2YXIgdzIgPSBzdyAvIDI7CiAgICAgIHZhciBoMiA9IHNoIC8gMjsKICAgICAgdmFyIHZtbFN0ciA9IFtdOwogICAgICB2YXIgVyA9IDEwOwogICAgICB2YXIgSCA9IDEwOyAvLyBGb3Igc29tZSByZWFzb24gdGhhdCBJJ3ZlIG5vdyBmb3Jnb3R0ZW4sIHVzaW5nIGRpdnMgZGlkbid0IHdvcmsKCiAgICAgIHZtbFN0ci5wdXNoKCcgPGdfdm1sXzpncm91cCcsICcgY29vcmRzaXplPSInLCBaICogVywgJywnLCBaICogSCwgJyInLCAnIGNvb3Jkb3JpZ2luPSIwLDAiJywgJyBzdHlsZT0id2lkdGg6JywgVywgJ3B4O2hlaWdodDonLCBILCAncHg7cG9zaXRpb246YWJzb2x1dGU7Jyk7IC8vIElmIGZpbHRlcnMgYXJlIG5lY2Vzc2FyeSAocm90YXRpb24gZXhpc3RzKSwgY3JlYXRlIHRoZW0KICAgICAgLy8gZmlsdGVycyBhcmUgYm9nLXNsb3csIHNvIG9ubHkgY3JlYXRlIHRoZW0gaWYgYWJic29sdXRlbHkgbmVjZXNzYXJ5CiAgICAgIC8vIFRoZSBmb2xsb3dpbmcgY2hlY2sgZG9lc24ndCBhY2NvdW50IGZvciBza2V3cyAod2hpY2ggZG9uJ3QgZXhpc3QKICAgICAgLy8gaW4gdGhlIGNhbnZhcyBzcGVjICh5ZXQpIGFueXdheS4KCiAgICAgIGlmICh0aGlzLm1fWzBdWzBdICE9IDEgfHwgdGhpcy5tX1swXVsxXSkgewogICAgICAgIHZhciBmaWx0ZXIgPSBbXTsgLy8gTm90ZSB0aGUgMTIvMjEgcmV2ZXJzYWwKCiAgICAgICAgZmlsdGVyLnB1c2goJ00xMT0nLCB0aGlzLm1fWzBdWzBdLCAnLCcsICdNMTI9JywgdGhpcy5tX1sxXVswXSwgJywnLCAnTTIxPScsIHRoaXMubV9bMF1bMV0sICcsJywgJ00yMj0nLCB0aGlzLm1fWzFdWzFdLCAnLCcsICdEeD0nLCBtcihkLnggLyBaKSwgJywnLCAnRHk9JywgbXIoZC55IC8gWiksICcnKTsgLy8gQm91bmRpbmcgYm94IGNhbGN1bGF0aW9uIChuZWVkIHRvIG1pbmltaXplIGRpc3BsYXllZCBhcmVhIHNvIHRoYXQKICAgICAgICAvLyBmaWx0ZXJzIGRvbid0IHdhc3RlIHRpbWUgb24gdW51c2VkIHBpeGVscy4KCiAgICAgICAgdmFyIG1heCA9IGQ7CiAgICAgICAgdmFyIGMyID0gdGhpcy5nZXRDb29yZHNfKGR4ICsgZHcsIGR5KTsKICAgICAgICB2YXIgYzMgPSB0aGlzLmdldENvb3Jkc18oZHgsIGR5ICsgZGgpOwogICAgICAgIHZhciBjNCA9IHRoaXMuZ2V0Q29vcmRzXyhkeCArIGR3LCBkeSArIGRoKTsKICAgICAgICBtYXgueCA9IG0ubWF4KG1heC54LCBjMi54LCBjMy54LCBjNC54KTsKICAgICAgICBtYXgueSA9IG0ubWF4KG1heC55LCBjMi55LCBjMy55LCBjNC55KTsKICAgICAgICB2bWxTdHIucHVzaCgncGFkZGluZzowICcsIG1yKG1heC54IC8gWiksICdweCAnLCBtcihtYXgueSAvIFopLCAncHggMDtmaWx0ZXI6cHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0Lk1hdHJpeCgnLCBmaWx0ZXIuam9pbignJyksICIsIHNpemluZ21ldGhvZD0nY2xpcCcpOyIpOwogICAgICB9IGVsc2UgewogICAgICAgIHZtbFN0ci5wdXNoKCd0b3A6JywgbXIoZC55IC8gWiksICdweDtsZWZ0OicsIG1yKGQueCAvIFopLCAncHg7Jyk7CiAgICAgIH0KCiAgICAgIHZtbFN0ci5wdXNoKCcgIj4nLCAnPGdfdm1sXzppbWFnZSBzcmM9IicsIGltYWdlLnNyYywgJyInLCAnIHN0eWxlPSJ3aWR0aDonLCBaICogZHcsICdweDsnLCAnIGhlaWdodDonLCBaICogZGgsICdweDsiJywgJyBjcm9wbGVmdD0iJywgc3ggLyB3LCAnIicsICcgY3JvcHRvcD0iJywgc3kgLyBoLCAnIicsICcgY3JvcHJpZ2h0PSInLCAodyAtIHN4IC0gc3cpIC8gdywgJyInLCAnIGNyb3Bib3R0b209IicsIChoIC0gc3kgLSBzaCkgLyBoLCAnIicsICcgLz4nLCAnPC9nX3ZtbF86Z3JvdXA+Jyk7CiAgICAgIHRoaXMuZWxlbWVudF8uaW5zZXJ0QWRqYWNlbnRIVE1MKCdCZWZvcmVFbmQnLCB2bWxTdHIuam9pbignJykpOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLnN0cm9rZSA9IGZ1bmN0aW9uIChhRmlsbCkgewogICAgICB2YXIgbGluZVN0ciA9IFtdOwogICAgICB2YXIgbGluZU9wZW4gPSBmYWxzZTsKICAgICAgdmFyIGEgPSBwcm9jZXNzU3R5bGUoYUZpbGwgPyB0aGlzLmZpbGxTdHlsZSA6IHRoaXMuc3Ryb2tlU3R5bGUpOwogICAgICB2YXIgY29sb3IgPSBhLmNvbG9yOwogICAgICB2YXIgb3BhY2l0eSA9IGEuYWxwaGEgKiB0aGlzLmdsb2JhbEFscGhhOwogICAgICB2YXIgVyA9IDEwOwogICAgICB2YXIgSCA9IDEwOwogICAgICBsaW5lU3RyLnB1c2goJzxnX3ZtbF86c2hhcGUnLCAnIGZpbGxlZD0iJywgISFhRmlsbCwgJyInLCAnIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDonLCBXLCAncHg7aGVpZ2h0OicsIEgsICdweDsiJywgJyBjb29yZG9yaWdpbj0iMCAwIiBjb29yZHNpemU9IicsIFogKiBXLCAnICcsIFogKiBILCAnIicsICcgc3Ryb2tlZD0iJywgIWFGaWxsLCAnIicsICcgcGF0aD0iJyk7CiAgICAgIHZhciBuZXdTZXEgPSBmYWxzZTsKICAgICAgdmFyIG1pbiA9IHsKICAgICAgICB4OiBudWxsLAogICAgICAgIHk6IG51bGwKICAgICAgfTsKICAgICAgdmFyIG1heCA9IHsKICAgICAgICB4OiBudWxsLAogICAgICAgIHk6IG51bGwKICAgICAgfTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jdXJyZW50UGF0aF8ubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgcCA9IHRoaXMuY3VycmVudFBhdGhfW2ldOwogICAgICAgIHZhciBjOwoKICAgICAgICBzd2l0Y2ggKHAudHlwZSkgewogICAgICAgICAgY2FzZSAnbW92ZVRvJzoKICAgICAgICAgICAgYyA9IHA7CiAgICAgICAgICAgIGxpbmVTdHIucHVzaCgnIG0gJywgbXIocC54KSwgJywnLCBtcihwLnkpKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAnbGluZVRvJzoKICAgICAgICAgICAgbGluZVN0ci5wdXNoKCcgbCAnLCBtcihwLngpLCAnLCcsIG1yKHAueSkpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICdjbG9zZSc6CiAgICAgICAgICAgIGxpbmVTdHIucHVzaCgnIHggJyk7CiAgICAgICAgICAgIHAgPSBudWxsOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICdiZXppZXJDdXJ2ZVRvJzoKICAgICAgICAgICAgbGluZVN0ci5wdXNoKCcgYyAnLCBtcihwLmNwMXgpLCAnLCcsIG1yKHAuY3AxeSksICcsJywgbXIocC5jcDJ4KSwgJywnLCBtcihwLmNwMnkpLCAnLCcsIG1yKHAueCksICcsJywgbXIocC55KSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgJ2F0JzoKICAgICAgICAgIGNhc2UgJ3dhJzoKICAgICAgICAgICAgbGluZVN0ci5wdXNoKCcgJywgcC50eXBlLCAnICcsIG1yKHAueCAtIHRoaXMuYXJjU2NhbGVYXyAqIHAucmFkaXVzKSwgJywnLCBtcihwLnkgLSB0aGlzLmFyY1NjYWxlWV8gKiBwLnJhZGl1cyksICcgJywgbXIocC54ICsgdGhpcy5hcmNTY2FsZVhfICogcC5yYWRpdXMpLCAnLCcsIG1yKHAueSArIHRoaXMuYXJjU2NhbGVZXyAqIHAucmFkaXVzKSwgJyAnLCBtcihwLnhTdGFydCksICcsJywgbXIocC55U3RhcnQpLCAnICcsIG1yKHAueEVuZCksICcsJywgbXIocC55RW5kKSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gLy8gVE9ETzogRm9sbG93aW5nIGlzIGJyb2tlbiBmb3IgY3VydmVzIGR1ZSB0bwogICAgICAgIC8vICAgICAgIG1vdmUgdG8gcHJvcGVyIHBhdGhzLgogICAgICAgIC8vIEZpZ3VyZSBvdXQgZGltZW5zaW9ucyBzbyB3ZSBjYW4gZG8gZ3JhZGllbnQgZmlsbHMKICAgICAgICAvLyBwcm9wZXJseQoKCiAgICAgICAgaWYgKHApIHsKICAgICAgICAgIGlmIChtaW4ueCA9PSBudWxsIHx8IHAueCA8IG1pbi54KSB7CiAgICAgICAgICAgIG1pbi54ID0gcC54OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChtYXgueCA9PSBudWxsIHx8IHAueCA+IG1heC54KSB7CiAgICAgICAgICAgIG1heC54ID0gcC54OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChtaW4ueSA9PSBudWxsIHx8IHAueSA8IG1pbi55KSB7CiAgICAgICAgICAgIG1pbi55ID0gcC55OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChtYXgueSA9PSBudWxsIHx8IHAueSA+IG1heC55KSB7CiAgICAgICAgICAgIG1heC55ID0gcC55OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgbGluZVN0ci5wdXNoKCcgIj4nKTsKCiAgICAgIGlmICghYUZpbGwpIHsKICAgICAgICB2YXIgbGluZVdpZHRoID0gdGhpcy5saW5lU2NhbGVfICogdGhpcy5saW5lV2lkdGg7IC8vIFZNTCBjYW5ub3QgY29ycmVjdGx5IHJlbmRlciBhIGxpbmUgaWYgdGhlIHdpZHRoIGlzIGxlc3MgdGhhbiAxcHguCiAgICAgICAgLy8gSW4gdGhhdCBjYXNlLCB3ZSBkaWx1dGUgdGhlIGNvbG9yIHRvIG1ha2UgdGhlIGxpbmUgbG9vayB0aGlubmVyLgoKICAgICAgICBpZiAobGluZVdpZHRoIDwgMSkgewogICAgICAgICAgb3BhY2l0eSAqPSBsaW5lV2lkdGg7CiAgICAgICAgfQoKICAgICAgICBsaW5lU3RyLnB1c2goJzxnX3ZtbF86c3Ryb2tlJywgJyBvcGFjaXR5PSInLCBvcGFjaXR5LCAnIicsICcgam9pbnN0eWxlPSInLCB0aGlzLmxpbmVKb2luLCAnIicsICcgbWl0ZXJsaW1pdD0iJywgdGhpcy5taXRlckxpbWl0LCAnIicsICcgZW5kY2FwPSInLCBwcm9jZXNzTGluZUNhcCh0aGlzLmxpbmVDYXApLCAnIicsICcgd2VpZ2h0PSInLCBsaW5lV2lkdGgsICdweCInLCAnIGNvbG9yPSInLCBjb2xvciwgJyIgLz4nKTsKICAgICAgfSBlbHNlIGlmIChfdHlwZW9mKHRoaXMuZmlsbFN0eWxlKSA9PSAnb2JqZWN0JykgewogICAgICAgIHZhciBmaWxsU3R5bGUgPSB0aGlzLmZpbGxTdHlsZTsKICAgICAgICB2YXIgYW5nbGUgPSAwOwogICAgICAgIHZhciBmb2N1cyA9IHsKICAgICAgICAgIHg6IDAsCiAgICAgICAgICB5OiAwCiAgICAgICAgfTsgLy8gYWRkaXRpb25hbCBvZmZzZXQKCiAgICAgICAgdmFyIHNoaWZ0ID0gMDsgLy8gc2NhbGUgZmFjdG9yIGZvciBvZmZzZXQKCiAgICAgICAgdmFyIGV4cGFuc2lvbiA9IDE7CgogICAgICAgIGlmIChmaWxsU3R5bGUudHlwZV8gPT0gJ2dyYWRpZW50JykgewogICAgICAgICAgdmFyIHgwID0gZmlsbFN0eWxlLngwXyAvIHRoaXMuYXJjU2NhbGVYXzsKICAgICAgICAgIHZhciB5MCA9IGZpbGxTdHlsZS55MF8gLyB0aGlzLmFyY1NjYWxlWV87CiAgICAgICAgICB2YXIgeDEgPSBmaWxsU3R5bGUueDFfIC8gdGhpcy5hcmNTY2FsZVhfOwogICAgICAgICAgdmFyIHkxID0gZmlsbFN0eWxlLnkxXyAvIHRoaXMuYXJjU2NhbGVZXzsKICAgICAgICAgIHZhciBwMCA9IHRoaXMuZ2V0Q29vcmRzXyh4MCwgeTApOwogICAgICAgICAgdmFyIHAxID0gdGhpcy5nZXRDb29yZHNfKHgxLCB5MSk7CiAgICAgICAgICB2YXIgZHggPSBwMS54IC0gcDAueDsKICAgICAgICAgIHZhciBkeSA9IHAxLnkgLSBwMC55OwogICAgICAgICAgYW5nbGUgPSBNYXRoLmF0YW4yKGR4LCBkeSkgKiAxODAgLyBNYXRoLlBJOyAvLyBUaGUgYW5nbGUgc2hvdWxkIGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4KCiAgICAgICAgICBpZiAoYW5nbGUgPCAwKSB7CiAgICAgICAgICAgIGFuZ2xlICs9IDM2MDsKICAgICAgICAgIH0gLy8gVmVyeSBzbWFsbCBhbmdsZXMgcHJvZHVjZSBhbiB1bmV4cGVjdGVkIHJlc3VsdCBiZWNhdXNlIHRoZXkgYXJlCiAgICAgICAgICAvLyBjb252ZXJ0ZWQgdG8gYSBzY2llbnRpZmljIG5vdGF0aW9uIHN0cmluZy4KCgogICAgICAgICAgaWYgKGFuZ2xlIDwgMWUtNikgewogICAgICAgICAgICBhbmdsZSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBwMCA9IHRoaXMuZ2V0Q29vcmRzXyhmaWxsU3R5bGUueDBfLCBmaWxsU3R5bGUueTBfKTsKICAgICAgICAgIHZhciB3aWR0aCA9IG1heC54IC0gbWluLng7CiAgICAgICAgICB2YXIgaGVpZ2h0ID0gbWF4LnkgLSBtaW4ueTsKICAgICAgICAgIGZvY3VzID0gewogICAgICAgICAgICB4OiAocDAueCAtIG1pbi54KSAvIHdpZHRoLAogICAgICAgICAgICB5OiAocDAueSAtIG1pbi55KSAvIGhlaWdodAogICAgICAgICAgfTsKICAgICAgICAgIHdpZHRoIC89IHRoaXMuYXJjU2NhbGVYXyAqIFo7CiAgICAgICAgICBoZWlnaHQgLz0gdGhpcy5hcmNTY2FsZVlfICogWjsKICAgICAgICAgIHZhciBkaW1lbnNpb24gPSBtLm1heCh3aWR0aCwgaGVpZ2h0KTsKICAgICAgICAgIHNoaWZ0ID0gMiAqIGZpbGxTdHlsZS5yMF8gLyBkaW1lbnNpb247CiAgICAgICAgICBleHBhbnNpb24gPSAyICogZmlsbFN0eWxlLnIxXyAvIGRpbWVuc2lvbiAtIHNoaWZ0OwogICAgICAgIH0gLy8gV2UgbmVlZCB0byBzb3J0IHRoZSBjb2xvciBzdG9wcyBpbiBhc2NlbmRpbmcgb3JkZXIgYnkgb2Zmc2V0LAogICAgICAgIC8vIG90aGVyd2lzZSBJRSB3b24ndCBpbnRlcnByZXQgaXQgY29ycmVjdGx5LgoKCiAgICAgICAgdmFyIHN0b3BzID0gZmlsbFN0eWxlLmNvbG9yc187CiAgICAgICAgc3RvcHMuc29ydChmdW5jdGlvbiAoY3MxLCBjczIpIHsKICAgICAgICAgIHJldHVybiBjczEub2Zmc2V0IC0gY3MyLm9mZnNldDsKICAgICAgICB9KTsKICAgICAgICB2YXIgbGVuZ3RoID0gc3RvcHMubGVuZ3RoOwogICAgICAgIHZhciBjb2xvcjEgPSBzdG9wc1swXS5jb2xvcjsKICAgICAgICB2YXIgY29sb3IyID0gc3RvcHNbbGVuZ3RoIC0gMV0uY29sb3I7CiAgICAgICAgdmFyIG9wYWNpdHkxID0gc3RvcHNbMF0uYWxwaGEgKiB0aGlzLmdsb2JhbEFscGhhOwogICAgICAgIHZhciBvcGFjaXR5MiA9IHN0b3BzW2xlbmd0aCAtIDFdLmFscGhhICogdGhpcy5nbG9iYWxBbHBoYTsKICAgICAgICB2YXIgY29sb3JzID0gW107CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZhciBzdG9wID0gc3RvcHNbaV07CiAgICAgICAgICBjb2xvcnMucHVzaChzdG9wLm9mZnNldCAqIGV4cGFuc2lvbiArIHNoaWZ0ICsgJyAnICsgc3RvcC5jb2xvcik7CiAgICAgICAgfSAvLyBXaGVuIGNvbG9ycyBhdHRyaWJ1dGUgaXMgdXNlZCwgdGhlIG1lYW5pbmdzIG9mIG9wYWNpdHkgYW5kIG86b3BhY2l0eTIKICAgICAgICAvLyBhcmUgcmV2ZXJzZWQuCgoKICAgICAgICBsaW5lU3RyLnB1c2goJzxnX3ZtbF86ZmlsbCB0eXBlPSInLCBmaWxsU3R5bGUudHlwZV8sICciJywgJyBtZXRob2Q9Im5vbmUiIGZvY3VzPSIxMDAlIicsICcgY29sb3I9IicsIGNvbG9yMSwgJyInLCAnIGNvbG9yMj0iJywgY29sb3IyLCAnIicsICcgY29sb3JzPSInLCBjb2xvcnMuam9pbignLCcpLCAnIicsICcgb3BhY2l0eT0iJywgb3BhY2l0eTIsICciJywgJyBnX29fOm9wYWNpdHkyPSInLCBvcGFjaXR5MSwgJyInLCAnIGFuZ2xlPSInLCBhbmdsZSwgJyInLCAnIGZvY3VzcG9zaXRpb249IicsIGZvY3VzLngsICcsJywgZm9jdXMueSwgJyIgLz4nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsaW5lU3RyLnB1c2goJzxnX3ZtbF86ZmlsbCBjb2xvcj0iJywgY29sb3IsICciIG9wYWNpdHk9IicsIG9wYWNpdHksICciIC8+Jyk7CiAgICAgIH0KCiAgICAgIGxpbmVTdHIucHVzaCgnPC9nX3ZtbF86c2hhcGU+Jyk7CiAgICAgIHRoaXMuZWxlbWVudF8uaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVFbmQnLCBsaW5lU3RyLmpvaW4oJycpKTsKICAgIH07CgogICAgY29udGV4dFByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnN0cm9rZSh0cnVlKTsKICAgIH07CgogICAgY29udGV4dFByb3RvdHlwZS5jbG9zZVBhdGggPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuY3VycmVudFBhdGhfLnB1c2goewogICAgICAgIHR5cGU6ICdjbG9zZScKICAgICAgfSk7CiAgICB9OwogICAgLyoqCiAgICAgKiBAcHJpdmF0ZQogICAgICovCgoKICAgIGNvbnRleHRQcm90b3R5cGUuZ2V0Q29vcmRzXyA9IGZ1bmN0aW9uIChhWCwgYVkpIHsKICAgICAgdmFyIG0gPSB0aGlzLm1fOwogICAgICByZXR1cm4gewogICAgICAgIHg6IFogKiAoYVggKiBtWzBdWzBdICsgYVkgKiBtWzFdWzBdICsgbVsyXVswXSkgLSBaMiwKICAgICAgICB5OiBaICogKGFYICogbVswXVsxXSArIGFZICogbVsxXVsxXSArIG1bMl1bMV0pIC0gWjIKICAgICAgfTsKICAgIH07CgogICAgY29udGV4dFByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbyA9IHt9OwogICAgICBjb3B5U3RhdGUodGhpcywgbyk7CiAgICAgIHRoaXMuYVN0YWNrXy5wdXNoKG8pOwogICAgICB0aGlzLm1TdGFja18ucHVzaCh0aGlzLm1fKTsKICAgICAgdGhpcy5tXyA9IG1hdHJpeE11bHRpcGx5KGNyZWF0ZU1hdHJpeElkZW50aXR5KCksIHRoaXMubV8pOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLnJlc3RvcmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGNvcHlTdGF0ZSh0aGlzLmFTdGFja18ucG9wKCksIHRoaXMpOwogICAgICB0aGlzLm1fID0gdGhpcy5tU3RhY2tfLnBvcCgpOwogICAgfTsKCiAgICBmdW5jdGlvbiBtYXRyaXhJc0Zpbml0ZShtKSB7CiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMzsgaisrKSB7CiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCAyOyBrKyspIHsKICAgICAgICAgIGlmICghaXNGaW5pdGUobVtqXVtrXSkgfHwgaXNOYU4obVtqXVtrXSkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0TShjdHgsIG0sIHVwZGF0ZUxpbmVTY2FsZSkgewogICAgICBpZiAoIW1hdHJpeElzRmluaXRlKG0pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjdHgubV8gPSBtOwoKICAgICAgaWYgKHVwZGF0ZUxpbmVTY2FsZSkgewogICAgICAgIC8vIEdldCB0aGUgbGluZSBzY2FsZS4KICAgICAgICAvLyBEZXRlcm1pbmFudCBvZiB0aGlzLm1fIG1lYW5zIGhvdyBtdWNoIHRoZSBhcmVhIGlzIGVubGFyZ2VkIGJ5IHRoZQogICAgICAgIC8vIHRyYW5zZm9ybWF0aW9uLiBTbyBpdHMgc3F1YXJlIHJvb3QgY2FuIGJlIHVzZWQgYXMgYSBzY2FsZSBmYWN0b3IKICAgICAgICAvLyBmb3Igd2lkdGguCiAgICAgICAgdmFyIGRldCA9IG1bMF1bMF0gKiBtWzFdWzFdIC0gbVswXVsxXSAqIG1bMV1bMF07CiAgICAgICAgY3R4LmxpbmVTY2FsZV8gPSBzcXJ0KGFicyhkZXQpKTsKICAgICAgfQogICAgfQoKICAgIGNvbnRleHRQcm90b3R5cGUudHJhbnNsYXRlID0gZnVuY3Rpb24gKGFYLCBhWSkgewogICAgICB2YXIgbTEgPSBbWzEsIDAsIDBdLCBbMCwgMSwgMF0sIFthWCwgYVksIDFdXTsKICAgICAgc2V0TSh0aGlzLCBtYXRyaXhNdWx0aXBseShtMSwgdGhpcy5tXyksIGZhbHNlKTsKICAgIH07CgogICAgY29udGV4dFByb3RvdHlwZS5yb3RhdGUgPSBmdW5jdGlvbiAoYVJvdCkgewogICAgICB2YXIgYyA9IG1jKGFSb3QpOwogICAgICB2YXIgcyA9IG1zKGFSb3QpOwogICAgICB2YXIgbTEgPSBbW2MsIHMsIDBdLCBbLXMsIGMsIDBdLCBbMCwgMCwgMV1dOwogICAgICBzZXRNKHRoaXMsIG1hdHJpeE11bHRpcGx5KG0xLCB0aGlzLm1fKSwgZmFsc2UpOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLnNjYWxlID0gZnVuY3Rpb24gKGFYLCBhWSkgewogICAgICB0aGlzLmFyY1NjYWxlWF8gKj0gYVg7CiAgICAgIHRoaXMuYXJjU2NhbGVZXyAqPSBhWTsKICAgICAgdmFyIG0xID0gW1thWCwgMCwgMF0sIFswLCBhWSwgMF0sIFswLCAwLCAxXV07CiAgICAgIHNldE0odGhpcywgbWF0cml4TXVsdGlwbHkobTEsIHRoaXMubV8pLCB0cnVlKTsKICAgIH07CgogICAgY29udGV4dFByb3RvdHlwZS50cmFuc2Zvcm0gPSBmdW5jdGlvbiAobTExLCBtMTIsIG0yMSwgbTIyLCBkeCwgZHkpIHsKICAgICAgdmFyIG0xID0gW1ttMTEsIG0xMiwgMF0sIFttMjEsIG0yMiwgMF0sIFtkeCwgZHksIDFdXTsKICAgICAgc2V0TSh0aGlzLCBtYXRyaXhNdWx0aXBseShtMSwgdGhpcy5tXyksIHRydWUpOwogICAgfTsKCiAgICBjb250ZXh0UHJvdG90eXBlLnNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uIChtMTEsIG0xMiwgbTIxLCBtMjIsIGR4LCBkeSkgewogICAgICB2YXIgbSA9IFtbbTExLCBtMTIsIDBdLCBbbTIxLCBtMjIsIDBdLCBbZHgsIGR5LCAxXV07CiAgICAgIHNldE0odGhpcywgbSwgdHJ1ZSk7CiAgICB9OwogICAgLyoqKioqKioqIFNUVUJTICoqKioqKioqLwoKCiAgICBjb250ZXh0UHJvdG90eXBlLmNsaXAgPSBmdW5jdGlvbiAoKSB7Ly8gVE9ETzogSW1wbGVtZW50CiAgICB9OwoKICAgIGNvbnRleHRQcm90b3R5cGUuYXJjVG8gPSBmdW5jdGlvbiAoKSB7Ly8gVE9ETzogSW1wbGVtZW50CiAgICB9OwoKICAgIGNvbnRleHRQcm90b3R5cGUuY3JlYXRlUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIG5ldyBDYW52YXNQYXR0ZXJuXygpOwogICAgfTsgLy8gR3JhZGllbnQgLyBQYXR0ZXJuIFN0dWJzCgoKICAgIGZ1bmN0aW9uIENhbnZhc0dyYWRpZW50XyhhVHlwZSkgewogICAgICB0aGlzLnR5cGVfID0gYVR5cGU7CiAgICAgIHRoaXMueDBfID0gMDsKICAgICAgdGhpcy55MF8gPSAwOwogICAgICB0aGlzLnIwXyA9IDA7CiAgICAgIHRoaXMueDFfID0gMDsKICAgICAgdGhpcy55MV8gPSAwOwogICAgICB0aGlzLnIxXyA9IDA7CiAgICAgIHRoaXMuY29sb3JzXyA9IFtdOwogICAgfQoKICAgIENhbnZhc0dyYWRpZW50Xy5wcm90b3R5cGUuYWRkQ29sb3JTdG9wID0gZnVuY3Rpb24gKGFPZmZzZXQsIGFDb2xvcikgewogICAgICBhQ29sb3IgPSBwcm9jZXNzU3R5bGUoYUNvbG9yKTsKICAgICAgdGhpcy5jb2xvcnNfLnB1c2goewogICAgICAgIG9mZnNldDogYU9mZnNldCwKICAgICAgICBjb2xvcjogYUNvbG9yLmNvbG9yLAogICAgICAgIGFscGhhOiBhQ29sb3IuYWxwaGEKICAgICAgfSk7CiAgICB9OwoKICAgIGZ1bmN0aW9uIENhbnZhc1BhdHRlcm5fKCkge30gLy8gc2V0IHVwIGV4dGVybnMKCgogICAgR192bWxDYW52YXNNYW5hZ2VyID0gR192bWxDYW52YXNNYW5hZ2VyXzsKICAgIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCA9IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF87CiAgICBDYW52YXNHcmFkaWVudCA9IENhbnZhc0dyYWRpZW50XzsKICAgIENhbnZhc1BhdHRlcm4gPSBDYW52YXNQYXR0ZXJuXzsKICB9KSgpOwp9IC8vIGlm"},{"version":3,"sources":["C:/Users/icald/VueJS/store_app/src/editor/js/excanvas.js"],"names":["document","createElement","getContext","m","Math","mr","round","ms","sin","mc","cos","abs","sqrt","Z","Z2","context_","CanvasRenderingContext2D_","slice","Array","prototype","bind","f","obj","var_args","a","call","arguments","apply","concat","G_vmlCanvasManager_","init","opt_doc","test","navigator","userAgent","window","opera","doc","attachEvent","init_","namespaces","add","styleSheets","ss","createStyleSheet","owningElement","id","cssText","els","getElementsByTagName","i","length","initElement","el","innerHTML","onPropertyChange","onResize","attrs","attributes","width","specified","style","nodeValue","clientWidth","height","clientHeight","e","srcElement","propertyName","clearRect","firstChild","dec2hex","j","toString","createMatrixIdentity","matrixMultiply","m1","m2","result","x","y","sum","z","copyState","o1","o2","fillStyle","lineCap","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle","globalAlpha","arcScaleX_","arcScaleY_","lineScale_","processStyle","styleString","str","alpha","String","substring","start","indexOf","end","guts","split","Number","substr","color","processLineCap","surfaceElement","m_","mStack_","aStack_","currentPath_","canvas","ownerDocument","overflow","position","appendChild","element_","contextPrototype","beginPath","moveTo","aX","aY","p","getCoords_","push","type","currentX_","currentY_","lineTo","bezierCurveTo","aCP1x","aCP1y","aCP2x","aCP2y","cp1","cp2","self","cp1x","cp1y","cp2x","cp2y","quadraticCurveTo","aCPx","aCPy","cp","arc","aRadius","aStartAngle","aEndAngle","aClockwise","arcType","xStart","yStart","xEnd","yEnd","pStart","pEnd","radius","rect","aWidth","aHeight","closePath","strokeRect","oldPath","stroke","fillRect","fill","createLinearGradient","aX0","aY0","aX1","aY1","gradient","CanvasGradient_","x0_","y0_","x1_","y1_","createRadialGradient","aR0","aR1","r0_","r1_","drawImage","image","dx","dy","dw","dh","sx","sy","sw","sh","oldRuntimeWidth","runtimeStyle","oldRuntimeHeight","w","h","Error","d","w2","h2","vmlStr","W","H","filter","max","c2","c3","c4","join","src","insertAdjacentHTML","aFill","lineStr","lineOpen","opacity","newSeq","min","c","angle","focus","shift","expansion","type_","x0","y0","x1","y1","p0","p1","atan2","PI","dimension","stops","colors_","sort","cs1","cs2","offset","color1","color2","opacity1","opacity2","colors","stop","save","o","restore","pop","matrixIsFinite","k","isFinite","isNaN","setM","ctx","updateLineScale","det","translate","rotate","aRot","s","scale","transform","m11","m12","m21","m22","setTransform","clip","arcTo","createPattern","CanvasPattern_","aType","addColorStop","aOffset","aColor","G_vmlCanvasManager","CanvasRenderingContext2D","CanvasGradient","CanvasPattern"],"mappings":"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","sourcesContent":["// Copyright 2006 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n// Known Issues:\n//\n// * Patterns are not implemented.\n// * Radial gradient are not implemented. The VML version of these look very\n//   different from the canvas one.\n// * Clipping paths are not implemented.\n// * Coordsize. The width and height attribute have higher priority than the\n//   width and height style values which isn't correct.\n// * Painting mode isn't implemented.\n// * Canvas width/height should is using content-box by default. IE in\n//   Quirks mode will draw the canvas using border-box. Either change your\n//   doctype to HTML5\n//   (http://www.whatwg.org/specs/web-apps/current-work/#the-doctype)\n//   or use Box Sizing Behavior from WebFX\n//   (http://webfx.eae.net/dhtml/boxsizing/boxsizing.html)\n// * Non uniform scaling does not correctly scale strokes.\n// * Optimize. There is always room for speed improvements.\n\n// Only add this code if we do not already have a canvas implementation\nif (!document.createElement('canvas').getContext) {\n\n(function() {\n\n  // alias some functions to make (compiled) code shorter\n  var m = Math;\n  var mr = m.round;\n  var ms = m.sin;\n  var mc = m.cos;\n  var abs = m.abs;\n  var sqrt = m.sqrt;\n\n  // this is used for sub pixel precision\n  var Z = 10;\n  var Z2 = Z / 2;\n\n  /**\n   * This funtion is assigned to the <canvas> elements as element.getContext().\n   * @this {HTMLElement}\n   * @return {CanvasRenderingContext2D_}\n   */\n  function getContext() {\n    return this.context_ ||\n        (this.context_ = new CanvasRenderingContext2D_(this));\n  }\n\n  var slice = Array.prototype.slice;\n\n  /**\n   * Binds a function to an object. The returned function will always use the\n   * passed in {@code obj} as {@code this}.\n   *\n   * Example:\n   *\n   *   g = bind(f, obj, a, b)\n   *   g(c, d) // will do f.call(obj, a, b, c, d)\n   *\n   * @param {Function} f The function to bind the object to\n   * @param {Object} obj The object that should act as this when the function\n   *     is called\n   * @param {*} var_args Rest arguments that will be used as the initial\n   *     arguments when the function is called\n   * @return {Function} A new function that has bound this\n   */\n  function bind(f, obj, var_args) {\n    var a = slice.call(arguments, 2);\n    return function() {\n      return f.apply(obj, a.concat(slice.call(arguments)));\n    };\n  }\n\n  var G_vmlCanvasManager_ = {\n    init: function(opt_doc) {\n      if (/MSIE/.test(navigator.userAgent) && !window.opera) {\n        var doc = opt_doc || document;\n        // Create a dummy element so that IE will allow canvas elements to be\n        // recognized.\n        doc.createElement('canvas');\n        doc.attachEvent('onreadystatechange', bind(this.init_, this, doc));\n      }\n    },\n\n    init_: function(doc) {\n      // create xmlns\n      if (!doc.namespaces['g_vml_']) {\n        doc.namespaces.add('g_vml_', 'urn:schemas-microsoft-com:vml',\n                           '#default#VML');\n\n      }\n      if (!doc.namespaces['g_o_']) {\n        doc.namespaces.add('g_o_', 'urn:schemas-microsoft-com:office:office',\n                           '#default#VML');\n      }\n\n      // Setup default CSS.  Only add one style sheet per document\n      if (!doc.styleSheets['ex_canvas_']) {\n        var ss = doc.createStyleSheet();\n        ss.owningElement.id = 'ex_canvas_';\n        ss.cssText = 'canvas{display:inline-block;overflow:hidden;' +\n            // default size is 300x150 in Gecko and Opera\n            'text-align:left;width:300px;height:150px}' +\n            'g_vml_\\\\:*{behavior:url(#default#VML)}' +\n            'g_o_\\\\:*{behavior:url(#default#VML)}';\n\n      }\n\n      // find all canvas elements\n      var els = doc.getElementsByTagName('canvas');\n      for (var i = 0; i < els.length; i++) {\n        this.initElement(els[i]);\n      }\n    },\n\n    /**\n     * Public initializes a canvas element so that it can be used as canvas\n     * element from now on. This is called automatically before the page is\n     * loaded but if you are creating elements using createElement you need to\n     * make sure this is called on the element.\n     * @param {HTMLElement} el The canvas element to initialize.\n     * @return {HTMLElement} the element that was created.\n     */\n    initElement: function(el) {\n      if (!el.getContext) {\n\n        el.getContext = getContext;\n\n        // Remove fallback content. There is no way to hide text nodes so we\n        // just remove all childNodes. We could hide all elements and remove\n        // text nodes but who really cares about the fallback content.\n        el.innerHTML = '';\n\n        // do not use inline function because that will leak memory\n        el.attachEvent('onpropertychange', onPropertyChange);\n        el.attachEvent('onresize', onResize);\n\n        var attrs = el.attributes;\n        if (attrs.width && attrs.width.specified) {\n          // TODO: use runtimeStyle and coordsize\n          // el.getContext().setWidth_(attrs.width.nodeValue);\n          el.style.width = attrs.width.nodeValue + 'px';\n        } else {\n          el.width = el.clientWidth;\n        }\n        if (attrs.height && attrs.height.specified) {\n          // TODO: use runtimeStyle and coordsize\n          // el.getContext().setHeight_(attrs.height.nodeValue);\n          el.style.height = attrs.height.nodeValue + 'px';\n        } else {\n          el.height = el.clientHeight;\n        }\n        //el.getContext().setCoordsize_()\n      }\n      return el;\n    }\n  };\n\n  function onPropertyChange(e) {\n    var el = e.srcElement;\n\n    switch (e.propertyName) {\n      case 'width':\n        el.style.width = el.attributes.width.nodeValue + 'px';\n        el.getContext().clearRect();\n        break;\n      case 'height':\n        el.style.height = el.attributes.height.nodeValue + 'px';\n        el.getContext().clearRect();\n        break;\n    }\n  }\n\n  function onResize(e) {\n    var el = e.srcElement;\n    if (el.firstChild) {\n      el.firstChild.style.width =  el.clientWidth + 'px';\n      el.firstChild.style.height = el.clientHeight + 'px';\n    }\n  }\n\n  G_vmlCanvasManager_.init();\n\n  // precompute \"00\" to \"FF\"\n  var dec2hex = [];\n  for (var i = 0; i < 16; i++) {\n    for (var j = 0; j < 16; j++) {\n      dec2hex[i * 16 + j] = i.toString(16) + j.toString(16);\n    }\n  }\n\n  function createMatrixIdentity() {\n    return [\n      [1, 0, 0],\n      [0, 1, 0],\n      [0, 0, 1]\n    ];\n  }\n\n  function matrixMultiply(m1, m2) {\n    var result = createMatrixIdentity();\n\n    for (var x = 0; x < 3; x++) {\n      for (var y = 0; y < 3; y++) {\n        var sum = 0;\n\n        for (var z = 0; z < 3; z++) {\n          sum += m1[x][z] * m2[z][y];\n        }\n\n        result[x][y] = sum;\n      }\n    }\n    return result;\n  }\n\n  function copyState(o1, o2) {\n    o2.fillStyle     = o1.fillStyle;\n    o2.lineCap       = o1.lineCap;\n    o2.lineJoin      = o1.lineJoin;\n    o2.lineWidth     = o1.lineWidth;\n    o2.miterLimit    = o1.miterLimit;\n    o2.shadowBlur    = o1.shadowBlur;\n    o2.shadowColor   = o1.shadowColor;\n    o2.shadowOffsetX = o1.shadowOffsetX;\n    o2.shadowOffsetY = o1.shadowOffsetY;\n    o2.strokeStyle   = o1.strokeStyle;\n    o2.globalAlpha   = o1.globalAlpha;\n    o2.arcScaleX_    = o1.arcScaleX_;\n    o2.arcScaleY_    = o1.arcScaleY_;\n    o2.lineScale_    = o1.lineScale_;\n  }\n\n  function processStyle(styleString) {\n    var str, alpha = 1;\n\n    styleString = String(styleString);\n    if (styleString.substring(0, 3) == 'rgb') {\n      var start = styleString.indexOf('(', 3);\n      var end = styleString.indexOf(')', start + 1);\n      var guts = styleString.substring(start + 1, end).split(',');\n\n      str = '#';\n      for (var i = 0; i < 3; i++) {\n        str += dec2hex[Number(guts[i])];\n      }\n\n      if (guts.length == 4 && styleString.substr(3, 1) == 'a') {\n        alpha = guts[3];\n      }\n    } else {\n      str = styleString;\n    }\n\n    return {color: str, alpha: alpha};\n  }\n\n  function processLineCap(lineCap) {\n    switch (lineCap) {\n      case 'butt':\n        return 'flat';\n      case 'round':\n        return 'round';\n      case 'square':\n      default:\n        return 'square';\n    }\n  }\n\n  /**\n   * This class implements CanvasRenderingContext2D interface as described by\n   * the WHATWG.\n   * @param {HTMLElement} surfaceElement The element that the 2D context should\n   * be associated with\n   */\n  function CanvasRenderingContext2D_(surfaceElement) {\n    this.m_ = createMatrixIdentity();\n\n    this.mStack_ = [];\n    this.aStack_ = [];\n    this.currentPath_ = [];\n\n    // Canvas context properties\n    this.strokeStyle = '#000';\n    this.fillStyle = '#000';\n\n    this.lineWidth = 1;\n    this.lineJoin = 'miter';\n    this.lineCap = 'butt';\n    this.miterLimit = Z * 1;\n    this.globalAlpha = 1;\n    this.canvas = surfaceElement;\n\n    var el = surfaceElement.ownerDocument.createElement('div');\n    el.style.width =  surfaceElement.clientWidth + 'px';\n    el.style.height = surfaceElement.clientHeight + 'px';\n    el.style.overflow = 'hidden';\n    el.style.position = 'absolute';\n    surfaceElement.appendChild(el);\n\n    this.element_ = el;\n    this.arcScaleX_ = 1;\n    this.arcScaleY_ = 1;\n    this.lineScale_ = 1;\n  }\n\n  var contextPrototype = CanvasRenderingContext2D_.prototype;\n  contextPrototype.clearRect = function() {\n    this.element_.innerHTML = '';\n  };\n\n  contextPrototype.beginPath = function() {\n    // TODO: Branch current matrix so that save/restore has no effect\n    //       as per safari docs.\n    this.currentPath_ = [];\n  };\n\n  contextPrototype.moveTo = function(aX, aY) {\n    var p = this.getCoords_(aX, aY);\n    this.currentPath_.push({type: 'moveTo', x: p.x, y: p.y});\n    this.currentX_ = p.x;\n    this.currentY_ = p.y;\n  };\n\n  contextPrototype.lineTo = function(aX, aY) {\n    var p = this.getCoords_(aX, aY);\n    this.currentPath_.push({type: 'lineTo', x: p.x, y: p.y});\n\n    this.currentX_ = p.x;\n    this.currentY_ = p.y;\n  };\n\n  contextPrototype.bezierCurveTo = function(aCP1x, aCP1y,\n                                            aCP2x, aCP2y,\n                                            aX, aY) {\n    var p = this.getCoords_(aX, aY);\n    var cp1 = this.getCoords_(aCP1x, aCP1y);\n    var cp2 = this.getCoords_(aCP2x, aCP2y);\n    bezierCurveTo(this, cp1, cp2, p);\n  };\n\n  // Helper function that takes the already fixed cordinates.\n  function bezierCurveTo(self, cp1, cp2, p) {\n    self.currentPath_.push({\n      type: 'bezierCurveTo',\n      cp1x: cp1.x,\n      cp1y: cp1.y,\n      cp2x: cp2.x,\n      cp2y: cp2.y,\n      x: p.x,\n      y: p.y\n    });\n    self.currentX_ = p.x;\n    self.currentY_ = p.y;\n  }\n\n  contextPrototype.quadraticCurveTo = function(aCPx, aCPy, aX, aY) {\n    // the following is lifted almost directly from\n    // http://developer.mozilla.org/en/docs/Canvas_tutorial:Drawing_shapes\n\n    var cp = this.getCoords_(aCPx, aCPy);\n    var p = this.getCoords_(aX, aY);\n\n    var cp1 = {\n      x: this.currentX_ + 2.0 / 3.0 * (cp.x - this.currentX_),\n      y: this.currentY_ + 2.0 / 3.0 * (cp.y - this.currentY_)\n    };\n    var cp2 = {\n      x: cp1.x + (p.x - this.currentX_) / 3.0,\n      y: cp1.y + (p.y - this.currentY_) / 3.0\n    };\n\n    bezierCurveTo(this, cp1, cp2, p);\n  };\n\n  contextPrototype.arc = function(aX, aY, aRadius,\n                                  aStartAngle, aEndAngle, aClockwise) {\n    aRadius *= Z;\n    var arcType = aClockwise ? 'at' : 'wa';\n\n    var xStart = aX + mc(aStartAngle) * aRadius - Z2;\n    var yStart = aY + ms(aStartAngle) * aRadius - Z2;\n\n    var xEnd = aX + mc(aEndAngle) * aRadius - Z2;\n    var yEnd = aY + ms(aEndAngle) * aRadius - Z2;\n\n    // IE won't render arches drawn counter clockwise if xStart == xEnd.\n    if (xStart == xEnd && !aClockwise) {\n      xStart += 0.125; // Offset xStart by 1/80 of a pixel. Use something\n                       // that can be represented in binary\n    }\n\n    var p = this.getCoords_(aX, aY);\n    var pStart = this.getCoords_(xStart, yStart);\n    var pEnd = this.getCoords_(xEnd, yEnd);\n\n    this.currentPath_.push({type: arcType,\n                           x: p.x,\n                           y: p.y,\n                           radius: aRadius,\n                           xStart: pStart.x,\n                           yStart: pStart.y,\n                           xEnd: pEnd.x,\n                           yEnd: pEnd.y});\n\n  };\n\n  contextPrototype.rect = function(aX, aY, aWidth, aHeight) {\n    this.moveTo(aX, aY);\n    this.lineTo(aX + aWidth, aY);\n    this.lineTo(aX + aWidth, aY + aHeight);\n    this.lineTo(aX, aY + aHeight);\n    this.closePath();\n  };\n\n  contextPrototype.strokeRect = function(aX, aY, aWidth, aHeight) {\n    var oldPath = this.currentPath_;\n    this.beginPath();\n\n    this.moveTo(aX, aY);\n    this.lineTo(aX + aWidth, aY);\n    this.lineTo(aX + aWidth, aY + aHeight);\n    this.lineTo(aX, aY + aHeight);\n    this.closePath();\n    this.stroke();\n\n    this.currentPath_ = oldPath;\n  };\n\n  contextPrototype.fillRect = function(aX, aY, aWidth, aHeight) {\n    var oldPath = this.currentPath_;\n    this.beginPath();\n\n    this.moveTo(aX, aY);\n    this.lineTo(aX + aWidth, aY);\n    this.lineTo(aX + aWidth, aY + aHeight);\n    this.lineTo(aX, aY + aHeight);\n    this.closePath();\n    this.fill();\n\n    this.currentPath_ = oldPath;\n  };\n\n  contextPrototype.createLinearGradient = function(aX0, aY0, aX1, aY1) {\n    var gradient = new CanvasGradient_('gradient');\n    gradient.x0_ = aX0;\n    gradient.y0_ = aY0;\n    gradient.x1_ = aX1;\n    gradient.y1_ = aY1;\n    return gradient;\n  };\n\n  contextPrototype.createRadialGradient = function(aX0, aY0, aR0,\n                                                   aX1, aY1, aR1) {\n    var gradient = new CanvasGradient_('gradientradial');\n    gradient.x0_ = aX0;\n    gradient.y0_ = aY0;\n    gradient.r0_ = aR0;\n    gradient.x1_ = aX1;\n    gradient.y1_ = aY1;\n    gradient.r1_ = aR1;\n    return gradient;\n  };\n\n  contextPrototype.drawImage = function(image, var_args) {\n    var dx, dy, dw, dh, sx, sy, sw, sh;\n\n    // to find the original width we overide the width and height\n    var oldRuntimeWidth = image.runtimeStyle.width;\n    var oldRuntimeHeight = image.runtimeStyle.height;\n    image.runtimeStyle.width = 'auto';\n    image.runtimeStyle.height = 'auto';\n\n    // get the original size\n    var w = image.width;\n    var h = image.height;\n\n    // and remove overides\n    image.runtimeStyle.width = oldRuntimeWidth;\n    image.runtimeStyle.height = oldRuntimeHeight;\n\n    if (arguments.length == 3) {\n      dx = arguments[1];\n      dy = arguments[2];\n      sx = sy = 0;\n      sw = dw = w;\n      sh = dh = h;\n    } else if (arguments.length == 5) {\n      dx = arguments[1];\n      dy = arguments[2];\n      dw = arguments[3];\n      dh = arguments[4];\n      sx = sy = 0;\n      sw = w;\n      sh = h;\n    } else if (arguments.length == 9) {\n      sx = arguments[1];\n      sy = arguments[2];\n      sw = arguments[3];\n      sh = arguments[4];\n      dx = arguments[5];\n      dy = arguments[6];\n      dw = arguments[7];\n      dh = arguments[8];\n    } else {\n      throw Error('Invalid number of arguments');\n    }\n\n    var d = this.getCoords_(dx, dy);\n\n    var w2 = sw / 2;\n    var h2 = sh / 2;\n\n    var vmlStr = [];\n\n    var W = 10;\n    var H = 10;\n\n    // For some reason that I've now forgotten, using divs didn't work\n    vmlStr.push(' <g_vml_:group',\n                ' coordsize=\"', Z * W, ',', Z * H, '\"',\n                ' coordorigin=\"0,0\"' ,\n                ' style=\"width:', W, 'px;height:', H, 'px;position:absolute;');\n\n    // If filters are necessary (rotation exists), create them\n    // filters are bog-slow, so only create them if abbsolutely necessary\n    // The following check doesn't account for skews (which don't exist\n    // in the canvas spec (yet) anyway.\n\n    if (this.m_[0][0] != 1 || this.m_[0][1]) {\n      var filter = [];\n\n      // Note the 12/21 reversal\n      filter.push('M11=', this.m_[0][0], ',',\n                  'M12=', this.m_[1][0], ',',\n                  'M21=', this.m_[0][1], ',',\n                  'M22=', this.m_[1][1], ',',\n                  'Dx=', mr(d.x / Z), ',',\n                  'Dy=', mr(d.y / Z), '');\n\n      // Bounding box calculation (need to minimize displayed area so that\n      // filters don't waste time on unused pixels.\n      var max = d;\n      var c2 = this.getCoords_(dx + dw, dy);\n      var c3 = this.getCoords_(dx, dy + dh);\n      var c4 = this.getCoords_(dx + dw, dy + dh);\n\n      max.x = m.max(max.x, c2.x, c3.x, c4.x);\n      max.y = m.max(max.y, c2.y, c3.y, c4.y);\n\n      vmlStr.push('padding:0 ', mr(max.x / Z), 'px ', mr(max.y / Z),\n                  'px 0;filter:progid:DXImageTransform.Microsoft.Matrix(',\n                  filter.join(''), \", sizingmethod='clip');\")\n    } else {\n      vmlStr.push('top:', mr(d.y / Z), 'px;left:', mr(d.x / Z), 'px;');\n    }\n\n    vmlStr.push(' \">' ,\n                '<g_vml_:image src=\"', image.src, '\"',\n                ' style=\"width:', Z * dw, 'px;',\n                ' height:', Z * dh, 'px;\"',\n                ' cropleft=\"', sx / w, '\"',\n                ' croptop=\"', sy / h, '\"',\n                ' cropright=\"', (w - sx - sw) / w, '\"',\n                ' cropbottom=\"', (h - sy - sh) / h, '\"',\n                ' />',\n                '</g_vml_:group>');\n\n    this.element_.insertAdjacentHTML('BeforeEnd',\n                                    vmlStr.join(''));\n  };\n\n  contextPrototype.stroke = function(aFill) {\n    var lineStr = [];\n    var lineOpen = false;\n    var a = processStyle(aFill ? this.fillStyle : this.strokeStyle);\n    var color = a.color;\n    var opacity = a.alpha * this.globalAlpha;\n\n    var W = 10;\n    var H = 10;\n\n    lineStr.push('<g_vml_:shape',\n                 ' filled=\"', !!aFill, '\"',\n                 ' style=\"position:absolute;width:', W, 'px;height:', H, 'px;\"',\n                 ' coordorigin=\"0 0\" coordsize=\"', Z * W, ' ', Z * H, '\"',\n                 ' stroked=\"', !aFill, '\"',\n                 ' path=\"');\n\n    var newSeq = false;\n    var min = {x: null, y: null};\n    var max = {x: null, y: null};\n\n    for (var i = 0; i < this.currentPath_.length; i++) {\n      var p = this.currentPath_[i];\n      var c;\n\n      switch (p.type) {\n        case 'moveTo':\n          c = p;\n          lineStr.push(' m ', mr(p.x), ',', mr(p.y));\n          break;\n        case 'lineTo':\n          lineStr.push(' l ', mr(p.x), ',', mr(p.y));\n          break;\n        case 'close':\n          lineStr.push(' x ');\n          p = null;\n          break;\n        case 'bezierCurveTo':\n          lineStr.push(' c ',\n                       mr(p.cp1x), ',', mr(p.cp1y), ',',\n                       mr(p.cp2x), ',', mr(p.cp2y), ',',\n                       mr(p.x), ',', mr(p.y));\n          break;\n        case 'at':\n        case 'wa':\n          lineStr.push(' ', p.type, ' ',\n                       mr(p.x - this.arcScaleX_ * p.radius), ',',\n                       mr(p.y - this.arcScaleY_ * p.radius), ' ',\n                       mr(p.x + this.arcScaleX_ * p.radius), ',',\n                       mr(p.y + this.arcScaleY_ * p.radius), ' ',\n                       mr(p.xStart), ',', mr(p.yStart), ' ',\n                       mr(p.xEnd), ',', mr(p.yEnd));\n          break;\n      }\n\n\n      // TODO: Following is broken for curves due to\n      //       move to proper paths.\n\n      // Figure out dimensions so we can do gradient fills\n      // properly\n      if (p) {\n        if (min.x == null || p.x < min.x) {\n          min.x = p.x;\n        }\n        if (max.x == null || p.x > max.x) {\n          max.x = p.x;\n        }\n        if (min.y == null || p.y < min.y) {\n          min.y = p.y;\n        }\n        if (max.y == null || p.y > max.y) {\n          max.y = p.y;\n        }\n      }\n    }\n    lineStr.push(' \">');\n\n    if (!aFill) {\n      var lineWidth = this.lineScale_ * this.lineWidth;\n\n      // VML cannot correctly render a line if the width is less than 1px.\n      // In that case, we dilute the color to make the line look thinner.\n      if (lineWidth < 1) {\n        opacity *= lineWidth;\n      }\n\n      lineStr.push(\n        '<g_vml_:stroke',\n        ' opacity=\"', opacity, '\"',\n        ' joinstyle=\"', this.lineJoin, '\"',\n        ' miterlimit=\"', this.miterLimit, '\"',\n        ' endcap=\"', processLineCap(this.lineCap), '\"',\n        ' weight=\"', lineWidth, 'px\"',\n        ' color=\"', color, '\" />'\n      );\n    } else if (typeof this.fillStyle == 'object') {\n      var fillStyle = this.fillStyle;\n      var angle = 0;\n      var focus = {x: 0, y: 0};\n\n      // additional offset\n      var shift = 0;\n      // scale factor for offset\n      var expansion = 1;\n\n      if (fillStyle.type_ == 'gradient') {\n        var x0 = fillStyle.x0_ / this.arcScaleX_;\n        var y0 = fillStyle.y0_ / this.arcScaleY_;\n        var x1 = fillStyle.x1_ / this.arcScaleX_;\n        var y1 = fillStyle.y1_ / this.arcScaleY_;\n        var p0 = this.getCoords_(x0, y0);\n        var p1 = this.getCoords_(x1, y1);\n        var dx = p1.x - p0.x;\n        var dy = p1.y - p0.y;\n        angle = Math.atan2(dx, dy) * 180 / Math.PI;\n\n        // The angle should be a non-negative number.\n        if (angle < 0) {\n          angle += 360;\n        }\n\n        // Very small angles produce an unexpected result because they are\n        // converted to a scientific notation string.\n        if (angle < 1e-6) {\n          angle = 0;\n        }\n      } else {\n        var p0 = this.getCoords_(fillStyle.x0_, fillStyle.y0_);\n        var width  = max.x - min.x;\n        var height = max.y - min.y;\n        focus = {\n          x: (p0.x - min.x) / width,\n          y: (p0.y - min.y) / height\n        };\n\n        width  /= this.arcScaleX_ * Z;\n        height /= this.arcScaleY_ * Z;\n        var dimension = m.max(width, height);\n        shift = 2 * fillStyle.r0_ / dimension;\n        expansion = 2 * fillStyle.r1_ / dimension - shift;\n      }\n\n      // We need to sort the color stops in ascending order by offset,\n      // otherwise IE won't interpret it correctly.\n      var stops = fillStyle.colors_;\n      stops.sort(function(cs1, cs2) {\n        return cs1.offset - cs2.offset;\n      });\n\n      var length = stops.length;\n      var color1 = stops[0].color;\n      var color2 = stops[length - 1].color;\n      var opacity1 = stops[0].alpha * this.globalAlpha;\n      var opacity2 = stops[length - 1].alpha * this.globalAlpha;\n\n      var colors = [];\n      for (var i = 0; i < length; i++) {\n        var stop = stops[i];\n        colors.push(stop.offset * expansion + shift + ' ' + stop.color);\n      }\n\n      // When colors attribute is used, the meanings of opacity and o:opacity2\n      // are reversed.\n      lineStr.push('<g_vml_:fill type=\"', fillStyle.type_, '\"',\n                   ' method=\"none\" focus=\"100%\"',\n                   ' color=\"', color1, '\"',\n                   ' color2=\"', color2, '\"',\n                   ' colors=\"', colors.join(','), '\"',\n                   ' opacity=\"', opacity2, '\"',\n                   ' g_o_:opacity2=\"', opacity1, '\"',\n                   ' angle=\"', angle, '\"',\n                   ' focusposition=\"', focus.x, ',', focus.y, '\" />');\n    } else {\n      lineStr.push('<g_vml_:fill color=\"', color, '\" opacity=\"', opacity,\n                   '\" />');\n    }\n\n    lineStr.push('</g_vml_:shape>');\n\n    this.element_.insertAdjacentHTML('beforeEnd', lineStr.join(''));\n  };\n\n  contextPrototype.fill = function() {\n    this.stroke(true);\n  }\n\n  contextPrototype.closePath = function() {\n    this.currentPath_.push({type: 'close'});\n  };\n\n  /**\n   * @private\n   */\n  contextPrototype.getCoords_ = function(aX, aY) {\n    var m = this.m_;\n    return {\n      x: Z * (aX * m[0][0] + aY * m[1][0] + m[2][0]) - Z2,\n      y: Z * (aX * m[0][1] + aY * m[1][1] + m[2][1]) - Z2\n    }\n  };\n\n  contextPrototype.save = function() {\n    var o = {};\n    copyState(this, o);\n    this.aStack_.push(o);\n    this.mStack_.push(this.m_);\n    this.m_ = matrixMultiply(createMatrixIdentity(), this.m_);\n  };\n\n  contextPrototype.restore = function() {\n    copyState(this.aStack_.pop(), this);\n    this.m_ = this.mStack_.pop();\n  };\n\n  function matrixIsFinite(m) {\n    for (var j = 0; j < 3; j++) {\n      for (var k = 0; k < 2; k++) {\n        if (!isFinite(m[j][k]) || isNaN(m[j][k])) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  function setM(ctx, m, updateLineScale) {\n    if (!matrixIsFinite(m)) {\n      return;\n    }\n    ctx.m_ = m;\n\n    if (updateLineScale) {\n      // Get the line scale.\n      // Determinant of this.m_ means how much the area is enlarged by the\n      // transformation. So its square root can be used as a scale factor\n      // for width.\n      var det = m[0][0] * m[1][1] - m[0][1] * m[1][0];\n      ctx.lineScale_ = sqrt(abs(det));\n    }\n  }\n\n  contextPrototype.translate = function(aX, aY) {\n    var m1 = [\n      [1,  0,  0],\n      [0,  1,  0],\n      [aX, aY, 1]\n    ];\n\n    setM(this, matrixMultiply(m1, this.m_), false);\n  };\n\n  contextPrototype.rotate = function(aRot) {\n    var c = mc(aRot);\n    var s = ms(aRot);\n\n    var m1 = [\n      [c,  s, 0],\n      [-s, c, 0],\n      [0,  0, 1]\n    ];\n\n    setM(this, matrixMultiply(m1, this.m_), false);\n  };\n\n  contextPrototype.scale = function(aX, aY) {\n    this.arcScaleX_ *= aX;\n    this.arcScaleY_ *= aY;\n    var m1 = [\n      [aX, 0,  0],\n      [0,  aY, 0],\n      [0,  0,  1]\n    ];\n\n    setM(this, matrixMultiply(m1, this.m_), true);\n  };\n\n  contextPrototype.transform = function(m11, m12, m21, m22, dx, dy) {\n    var m1 = [\n      [m11, m12, 0],\n      [m21, m22, 0],\n      [dx,  dy,  1]\n    ];\n\n    setM(this, matrixMultiply(m1, this.m_), true);\n  };\n\n  contextPrototype.setTransform = function(m11, m12, m21, m22, dx, dy) {\n    var m = [\n      [m11, m12, 0],\n      [m21, m22, 0],\n      [dx,  dy,  1]\n    ];\n\n    setM(this, m, true);\n  };\n\n  /******** STUBS ********/\n  contextPrototype.clip = function() {\n    // TODO: Implement\n  };\n\n  contextPrototype.arcTo = function() {\n    // TODO: Implement\n  };\n\n  contextPrototype.createPattern = function() {\n    return new CanvasPattern_;\n  };\n\n  // Gradient / Pattern Stubs\n  function CanvasGradient_(aType) {\n    this.type_ = aType;\n    this.x0_ = 0;\n    this.y0_ = 0;\n    this.r0_ = 0;\n    this.x1_ = 0;\n    this.y1_ = 0;\n    this.r1_ = 0;\n    this.colors_ = [];\n  }\n\n  CanvasGradient_.prototype.addColorStop = function(aOffset, aColor) {\n    aColor = processStyle(aColor);\n    this.colors_.push({offset: aOffset,\n                       color: aColor.color,\n                       alpha: aColor.alpha});\n  };\n\n  function CanvasPattern_() {}\n\n  // set up externs\n  G_vmlCanvasManager = G_vmlCanvasManager_;\n  CanvasRenderingContext2D = CanvasRenderingContext2D_;\n  CanvasGradient = CanvasGradient_;\n  CanvasPattern = CanvasPattern_;\n\n})();\n\n} // if\n"]}]}